const _0x3fcedf=_0x1b8f;(function(_0x6f5241,_0x56f151){const _0x2aed19=_0x1b8f,_0x309133=_0x6f5241();while(!![]){try{const _0x586581=parseInt(_0x2aed19(0x107))/0x1+-parseInt(_0x2aed19(0xd0))/0x2*(-parseInt(_0x2aed19(0xe7))/0x3)+parseInt(_0x2aed19(0xf5))/0x4*(-parseInt(_0x2aed19(0xfe))/0x5)+parseInt(_0x2aed19(0x105))/0x6+parseInt(_0x2aed19(0xde))/0x7*(parseInt(_0x2aed19(0xdd))/0x8)+parseInt(_0x2aed19(0xdc))/0x9+-parseInt(_0x2aed19(0xe6))/0xa*(parseInt(_0x2aed19(0xcc))/0xb);if(_0x586581===_0x56f151)break;else _0x309133['push'](_0x309133['shift']());}catch(_0x2efb1b){_0x309133['push'](_0x309133['shift']());}}}(_0x526e,0xb1d1d));import{UtilApplications}from'./UtilApplications.js';import{SharedConsts}from'../shared/SharedConsts.js';function _0x526e(){const _0x2af6c5=['65GhZgnw','Unknown\x20Background','_SIDE_LOAD_OPTS','background','name','replace','pGetBackgroundFeatureItem','7879848vWCMVU','isImportDescription','619107ClcbLu','isAddPermission','source','getBackgroundStub','feat','_getRequirementsString','length','trim','get','pGetCompendiumImage','STUB_BACKGROUND','_pGetEffectsSideLoaded','27363314KdGLdp','push','_pGetCompendiumFeatureImage','filter','172oeiTEv','_baseSrd','pGetWithDescriptionPlugins','fluff','<div>','foundryBackgroundFeature','setFirstSection','getNameWithSourcePart','_getCompendiumAliases','copy','modules/','PG_BACKGROUNDS','943641RXldxC','184dhlZZr','262458MDyTGk','importBackground','_getBackgroundFlags','player','backgroundFeature','isActorItem','/media/icon/farmer.svg','backgroundSource','10avqmbA','42888rWmOek','pGeBackgroundSideData','_getFauxBackgroundFeature','backgroundName','render','defaultPermission','_pGetDataSideLoaded','_IMG_FALLBACK','entries','</div>','isDirectImport','pGetFluff','data.requirements','bind','280972MLeCuQ','_getCompendiumFeatureAliases','_pGetFlagsSideLoaded','filterValues','_SIDE_LOAD_OPTS_FEATURE','pGetItemActorPassive','<hr>','getCleanEntityName','permission'];_0x526e=function(){return _0x2af6c5;};return _0x526e();}import{Config}from'./Config.js';function _0x1b8f(_0x1384ac,_0x17a655){const _0x526e12=_0x526e();return _0x1b8f=function(_0x1b8f1f,_0x4304ab){_0x1b8f1f=_0x1b8f1f-0xcb;let _0x335b9d=_0x526e12[_0x1b8f1f];return _0x335b9d;},_0x1b8f(_0x1384ac,_0x17a655);}import{DataConverter}from'./DataConverter.js';import{Vetools}from'./Vetools.js';import{UtilDataConverter}from'./UtilDataConverter.js';import{UtilCompendium}from'./UtilCompendium.js';class DataConverterBackground extends DataConverter{static [_0x3fcedf(0x100)]={'propBrew':'foundryBackground','fnLoadJson':Vetools[_0x3fcedf(0xe8)]['bind'](Vetools),'propJson':_0x3fcedf(0x101)};static [_0x3fcedf(0xf9)]={'propBrew':_0x3fcedf(0xd5),'fnLoadJson':Vetools['pGeBackgroundSideData'][_0x3fcedf(0xf4)](Vetools),'propJson':'backgroundFeature','propsMatch':[_0x3fcedf(0xe5),_0x3fcedf(0xea),_0x3fcedf(0x109),'name']};static [_0x3fcedf(0xee)]=_0x3fcedf(0xda)+SharedConsts['MODULE_NAME']+_0x3fcedf(0xe4);static[_0x3fcedf(0xd8)](_0x491f63){const _0x463de9=_0x3fcedf;if(!_0x491f63[_0x463de9(0x102)])return[];return[];}static async['pGetBackgroundItem'](_0x20180b,_0x8e8790){const _0x2907d3=_0x3fcedf;_0x8e8790=_0x8e8790||{};if(_0x8e8790['actor'])_0x8e8790[_0x2907d3(0xe3)]=!![];const _0x97393f=_0x8e8790['fluff']||await Renderer[_0x2907d3(0x101)][_0x2907d3(0xf2)](_0x20180b),_0x321180=Config[_0x2907d3(0x10f)](_0x2907d3(0xdf),_0x2907d3(0x106))?await UtilDataConverter[_0x2907d3(0xd2)](()=>{const _0x37e4d3=_0x2907d3,_0x2701fe=[_0x97393f?.[_0x37e4d3(0xef)]?.[_0x37e4d3(0x10d)]?Renderer[_0x37e4d3(0x10f)]()[_0x37e4d3(0xd6)](!![])[_0x37e4d3(0xeb)]({'type':_0x37e4d3(0xef),'entries':_0x97393f?.[_0x37e4d3(0xef)]}):'',Renderer['get']()[_0x37e4d3(0xd6)](!![])['render']({'type':_0x37e4d3(0xef),'entries':_0x20180b[_0x37e4d3(0xef)]})][_0x37e4d3(0xcf)](Boolean);return _0x37e4d3(0xd4)+_0x2701fe['join'](_0x37e4d3(0xfb))+_0x37e4d3(0xf0);}):'',_0x248788=await this['_pGetSaveImagePath'](_0x20180b,{'propCompendium':_0x2907d3(0x101),'fluff':_0x97393f}),_0x4cca10=await this[_0x2907d3(0xed)](_0x20180b),_0x21f6ad=await this[_0x2907d3(0xf7)](_0x20180b),_0x1cf293=await this['_pGetAdvancementSideLoaded'](_0x20180b),_0x3f3797=await this[_0x2907d3(0xcb)]({'ent':_0x20180b,'img':_0x248788});DataConverter['mutEffectsDisabledTransfer'](_0x3f3797,_0x2907d3(0xdf));const _0x3865c8={'name':UtilApplications[_0x2907d3(0xfc)](UtilDataConverter[_0x2907d3(0xd7)](_0x20180b)),'type':_0x2907d3(0x101),'data':{'description':{'value':_0x321180,'chat':'','unidentified':''},'source':UtilDataConverter['getSourceWithPagePart'](_0x20180b),'damage':{'parts':[]},'activation':{'type':'','cost':0x0,'condition':''},'duration':{'value':null,'units':''},'target':{'value':null,'units':'','type':''},'range':{'value':null,'long':null,'units':''},'uses':{'value':0x0,'max':0x0,'per':null},'ability':null,'actionType':'','attackBonus':null,'chatFlavor':'','critical':{'threshold':null,'damage':''},'formula':'','save':{'ability':'','dc':null},'requirements':'','recharge':{'value':null,'charged':![]},'consume':{'type':'','target':'','amount':null},'advancement':[..._0x1cf293||[]],..._0x4cca10},'flags':{...this[_0x2907d3(0xe0)](_0x20180b,_0x8e8790),..._0x21f6ad},'effects':_0x3f3797,'img':_0x248788};if(_0x8e8790['defaultPermission']!=null)_0x3865c8['permission']={'default':_0x8e8790[_0x2907d3(0xec)]};else{if(_0x8e8790[_0x2907d3(0x108)])_0x3865c8[_0x2907d3(0xfd)]={'default':Config[_0x2907d3(0x10f)]('importBackground','permissions')};}return _0x3865c8;}static[_0x3fcedf(0xe0)](_0x5f1bdb,_0x50078c){const _0x2941f1=_0x3fcedf,_0x380091={[SharedConsts['MODULE_NAME_FAKE']]:{'page':UrlUtil['PG_BACKGROUNDS'],'source':_0x5f1bdb['source'],'hash':UrlUtil['URL_TO_HASH_BUILDER'][UrlUtil[_0x2941f1(0xdb)]](_0x5f1bdb),'propDroppable':_0x2941f1(0x101),'filterValues':_0x50078c[_0x2941f1(0xf8)]}};if(_0x50078c['isActorItem'])_0x380091[SharedConsts['MODULE_NAME_FAKE']][_0x2941f1(0xf1)]=!![];return _0x380091;}static async[_0x3fcedf(0x104)](_0x49d57e,_0x3d1258,_0x344230,_0x21df95){const _0x1c482f=_0x3fcedf,_0x4459ef=this[_0x1c482f(0xe9)](_0x49d57e,_0x3d1258),_0x182e6b=await this[_0x1c482f(0xce)](_0x49d57e,_0x4459ef,_0x21df95),_0x104462=await this[_0x1c482f(0xcb)]({'ent':_0x4459ef,'img':_0x182e6b},{'propOpts':_0x1c482f(0xf9)});return DataConverter['mutEffectsDisabledTransfer'](_0x104462,'importBackground'),DataConverter[_0x1c482f(0xfa)](_0x3d1258,{'mode':_0x1c482f(0xe1),'img':_0x182e6b,'fvttType':_0x1c482f(0x10b),'source':_0x49d57e[_0x1c482f(0x109)],'actor':_0x344230,'requirements':this[_0x1c482f(0x10c)](_0x49d57e),'additionalData':await this[_0x1c482f(0xed)](_0x4459ef,{'propOpts':'_SIDE_LOAD_OPTS_FEATURE'}),'additionalFlags':await this[_0x1c482f(0xf7)](_0x4459ef,{'propOpts':'_SIDE_LOAD_OPTS_FEATURE'}),'effects':_0x104462});}static[_0x3fcedf(0xe9)](_0x8946c2,_0x5df978){const _0x51dc71=_0x3fcedf;return{'source':_0x8946c2['source'],'backgroundName':_0x8946c2['name'],'backgroundSource':_0x8946c2[_0x51dc71(0x109)],'srd':_0x8946c2['srd']||_0x8946c2[_0x51dc71(0xd1)],...MiscUtil['copy'](_0x5df978)};}static[_0x3fcedf(0x10c)](_0x3d9f13){return _0x3d9f13['name'];}static async[_0x3fcedf(0xce)](_0x4dbe07,_0xb004e7,_0x241720){const _0x7c3aa4=_0x3fcedf,_0xc4b647=await UtilCompendium[_0x7c3aa4(0x110)](_0x7c3aa4(0xe2),_0xb004e7,{'fnGetAliases':this[_0x7c3aa4(0xf6)][_0x7c3aa4(0xf4)](this,_0x4dbe07),'deepKeys':[_0x7c3aa4(0xf3)]});if(_0xc4b647)return _0xc4b647;return this['_pGetSaveImagePath'](_0x4dbe07,{'propCompendium':_0x7c3aa4(0x101),'fluff':_0x241720[_0x7c3aa4(0xd3)]});}static[_0x3fcedf(0xf6)](_0x3bd33d,_0x1f91bc){const _0x1f9976=_0x3fcedf;if(!_0x3bd33d[_0x1f9976(0x102)])return[];if(!_0x1f91bc['name'])return[];const _0x163b24=[];_0x163b24[_0x1f9976(0xcd)]({'name':_0x1f91bc['name'],'data.requirements':_0x3bd33d['name']});const _0x39174c=_0x1f91bc['name'][_0x1f9976(0x103)](/^Feature:?\s*/i,'')[_0x1f9976(0x10e)]();return _0x39174c!==_0x1f91bc[_0x1f9976(0x102)]&&_0x163b24[_0x1f9976(0xcd)]({'name':_0x39174c,'data.requirements':_0x3bd33d[_0x1f9976(0x102)]}),_0x163b24;}static[_0x3fcedf(0x10a)](){const _0xca2f37=_0x3fcedf;return MiscUtil[_0xca2f37(0xd9)](DataConverterBackground[_0xca2f37(0x111)]);}}DataConverterBackground['STUB_BACKGROUND']={'name':_0x3fcedf(0xff),'source':SRC_PHB,'_isStub':!![]};export{DataConverterBackground};