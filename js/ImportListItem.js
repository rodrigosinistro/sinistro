const _0x513340=_0x115f;(function(_0x52ab3f,_0x23f58b){const _0x302fa1=_0x115f,_0x27fcf6=_0x52ab3f();while(!![]){try{const _0x23ee3e=-parseInt(_0x302fa1(0x128))/0x1*(parseInt(_0x302fa1(0x13f))/0x2)+parseInt(_0x302fa1(0xb7))/0x3+-parseInt(_0x302fa1(0xcf))/0x4*(parseInt(_0x302fa1(0xdf))/0x5)+parseInt(_0x302fa1(0xd0))/0x6+parseInt(_0x302fa1(0x119))/0x7+parseInt(_0x302fa1(0x154))/0x8+-parseInt(_0x302fa1(0x137))/0x9;if(_0x23ee3e===_0x23f58b)break;else _0x27fcf6['push'](_0x27fcf6['shift']());}catch(_0x6c24aa){_0x27fcf6['push'](_0x27fcf6['shift']());}}}(_0x3dd5,0x585e3));import{ImportCustomizer,ImportedDocument,ImportList,ImportSummary}from'./ImportList.js';import{Vetools}from'./Vetools.js';import{LGT}from'./Util.js';import{DataConverterItem}from'./DataConverterItem.js';function _0x3dd5(){const _0x46eb36=['Failed\x20to\x20apply\x20currency\x20to\x20actor!\x20','Unhandled\x20pack\x20contents\x20type\x20\x22','_pImportEntry','special','_pFnPostProcessEntries','Actor','/template/ImportListItemCustomizer.hbs','MODULE_LOCATION','SOURCE_TYP_CUSTOM','getFolderPathMeta','Customize\x20Import','render','Name','valueMult','atomicPackContents','trim',')\x20into\x20constituent\x20items:\x20','isDataOnly','getItemTypeName','sourceJsonToFull','_pImportEntry_pImportToActor_isThrowableItem','absorbFnBindListenersRadio','items','_pImportEntry_pImportToActor_isSmartStackableItem','itemWeightToFull','DataSourceUrl','_pImportEntry_getSheetItemsAmmo','ele','click','isToken','hover','toLowerCase','MODULE_NAME','copy','Import\x20Items','loadRawJSON','VALID_FOUNDRY_ITEM_TYPES_IMPORT','importItem','URL_TO_HASH_BUILDER','Custom\x20URL','_typeListText','length','_list','log','Importing\x20item\x20\x22','_$btnReset','_pGetPackItemMetas','_activateListeners_initRunButtonsAdditional_genericMods','_pImportEntry_pImportToActor_getExistingStackableItem','DataSourceFile','baseBrewUrl','5etools-items','weight','cost','STORAGE_DMSCREEN_TEMP_SUBLIST','has','1194645vxUuAZ','_pGetSources','titleCase','_pageFilter','btn-run-mods','data','sheetItemsAmmo','pUpdateEmbeddedDocuments','Poison','close','hasSourceJson','Cost','some','STACKABLE_FOUNDRY_ITEM_TYPES_IMPORT','PG_ITEMS','isSplitAtomicPacksActor','Items','Item\x20\x22','Wondrous\x20Item','split','text-center','_pImportEntry_pImportToDataOnly','.search','_dataList','751484VqjTis','1266150AcYIRn','_isRadio','C_ITEM_ATTUNEMENT_SMART','sourceJsonToAbv','Unknown\x20Rarity','sheet','sourceClassName','getData','isSplitPacksActor','pCacheAndGet','SRD','sourceJsonToColor','MODULE_NAME_FAKE','absorbFnBindListeners','join','10litgkZ','[name=\x22sel-foundry-type\x22]','documentName','pGetItemItem','getItemSource','wondrous','_pImportEntry_pImportToDirectoryGeneric_pGetImportableData','val','TASK_EXIT_COMPLETE','item','isSiteSource','_pImportEntry_pImportToActor','_configGroup','Type','parent','Rarity','all','_pImportEntry_pDoLoadBrewMeta','[name=\x22btn-reset\x22]','currency','enhanceItem','quantity','import','itemFluff','absorbFnGetData','1-4','1-5','forEach','name','brew','Currency','uppercaseFirst','_attunementCategory','SOURCE_TYP_OFFICIAL_ALL','pGetItemsFromHomebrew','sortItems','contents','map','attunement','reset','rarity','type','get','inventoryStackingMode','Customize\x20and\x20Import...','HOMEBREW_INDEX__SOURCE','_pImportEntry_pImportToActor_pAddItem','error','_pImportEntry_pImportToDirectoryGeneric','pAddCurrencyToActor','TASK_EXIT_COMPLETE_DATA_ONLY','FLAG_TYPE_CURRENCY','preCreateItem','isTemp','toTitleCase','push','stringify','_vType','4289005YHguWX','find','Error(s)\x20when\x20breaking\x20','poison','sourceShort','Generic\x20Variant','ImportCustomizer','flags','_actor','replace','_pImportEntry_pImportToActor_pUpdateItemPostAdd','Importing\x20currency\x20\x22','localize','getDisplayCurrency','typeText','107kFPZDD','consumableType','Unknown','Source','fluff','document','STR_SEE_CONSOLE','getItemCompendiumAliases','.veapp__list','itemValueToFull','_pGetSourcesHomebrew','filterValues','_page','DISPLAY_NAME_TYPE_PLURAL','_initCreateSheetItemHook_currency','4983507NHBFpb','ITEM.Type','_pImportEntry_pImportToActor_pImportPackItem','string','value','constructor','notifications','sourceJsonToStylePart','3186JDHFkM','_pImportEntry_pImportToActor_pAddOrUpdateItem','_activateListeners_initList','loadJSON','srd','_activateListeners_bindControls','doAbsorbItems','pInit','catch','populatePropertyAndTypeReference','Unknown\x20Type','getFileUrl','source','C_ITEM_ATTUNEMENT_ALWAYS','init','_isPackSplitImport','C_ITEM_ATTUNEMENT_NEVER','STR_GENERIC','[name=\x22btn-run\x22]','consumable','pImportCurrency','1919328SOzsqH','magicvariant','pGetItems','pAddActorItems','ammo','Weight','ammoType','Upload\x20File','foundryType','ascSortLower'];_0x3dd5=function(){return _0x46eb36;};return _0x3dd5();}import{Config}from'./Config.js';import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{UtilDataSource}from'./UtilDataSource.js';function _0x115f(_0x5bdd54,_0x185228){const _0x3dd588=_0x3dd5();return _0x115f=function(_0x115ff2,_0x1b7518){_0x115ff2=_0x115ff2-0xa2;let _0x96ceee=_0x3dd588[_0x115ff2];return _0x96ceee;},_0x115f(_0x5bdd54,_0x185228);}import{UtilActors}from'./UtilActors.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilDocuments}from'./UtilDocuments.js';import{ConfigConsts}from'./ConfigConsts.js';import{UtilDataConverter}from'./UtilDataConverter.js';class ImportListItem extends ImportList{static ['ID']=_0x513340(0x174);static [_0x513340(0x135)]=_0x513340(0xc7);static ['_']=this['registerImpl'](this);static[_0x513340(0x14d)](){const _0x1f9418=_0x513340;this['_initCreateSheetItemHook']({'prop':_0x1f9418(0xe8),'importerName':'Item'}),this[_0x1f9418(0x136)]();}constructor(_0x271d24){const _0x49d429=_0x513340;_0x271d24=_0x271d24||{},super({'title':_0x49d429(0x180)},_0x271d24,{'dirsHomebrew':[_0x49d429(0xe8),'baseitem',_0x49d429(0x155)],'namespace':_0x49d429(0xe8),'titleSearch':_0x49d429(0x174),'sidebarTab':'items','gameProp':_0x49d429(0x174),'defaultFolderPath':[_0x49d429(0xc7)],'fnListSort':PageFilterItems[_0x49d429(0x102)],'pageFilter':new PageFilterItems({'filterOpts':{'Category':{'deselFn':_0x30d7bb=>_0x30d7bb===_0x49d429(0x11e)}}}),'page':UrlUtil['PG_ITEMS'],'isPreviewable':!![],'isDedupable':!![],'configGroup':'importItem'}),this['_fluffLookup']=null;}async[_0x513340(0xb8)](){const _0x3906c4=_0x513340,_0x3e7ead={'pPostLoad':async _0x8a5e1d=>{const _0x3aeb47=_0x115f;return Renderer[_0x3aeb47(0xe8)][_0x3aeb47(0x101)](_0x8a5e1d);}};return[new UtilDataSource['DataSourceSpecial'](Config[_0x3906c4(0x109)]('ui','isStreamerMode')?_0x3906c4(0xda):'5etools',async()=>(await Vetools[_0x3906c4(0x156)]())[_0x3906c4(0xe8)],{'cacheKey':_0x3906c4(0xb2),'filterTypes':[UtilDataSource[_0x3906c4(0x100)]],'isDefault':!![]}),new UtilDataSource[(_0x3906c4(0x177))](_0x3906c4(0xa6),'',{..._0x3e7ead,'filterTypes':[UtilDataSource[_0x3906c4(0x166)]]}),new UtilDataSource[(_0x3906c4(0xb0))](_0x3906c4(0x15b),{..._0x3e7ead,'filterTypes':[UtilDataSource[_0x3906c4(0x166)]]}),...await this[_0x3906c4(0x132)](_0x3e7ead)];}['getData'](){const _0x5a2abf=_0x513340;return{...super[_0x5a2abf(0xd7)](),'buttonsAdditional':[{'name':_0x5a2abf(0xbb),'text':_0x5a2abf(0x10b)}],'cols':[{'name':_0x5a2abf(0x16a),'width':0x3,'field':'name'},{'name':_0x5a2abf(0xec),'width':'3-2','field':_0x5a2abf(0x108)},{'name':_0x5a2abf(0xc2),'width':_0x5a2abf(0xf8),'field':_0x5a2abf(0xb4),'rowClassName':_0x5a2abf(0xcb)},{'name':_0x5a2abf(0x159),'width':_0x5a2abf(0xf8),'field':_0x5a2abf(0xb3),'rowClassName':_0x5a2abf(0xcb)},{'name':'A.','width':'0-5','field':_0x5a2abf(0x105),'rowClassName':_0x5a2abf(0xcb)},{'name':_0x5a2abf(0xee),'width':_0x5a2abf(0xf9),'field':_0x5a2abf(0x107),'rowClassName':_0x5a2abf(0xcb)},{'name':_0x5a2abf(0x12b),'width':0x1,'field':_0x5a2abf(0x14b),'titleProp':'sourceLong','displayProp':_0x5a2abf(0x11d),'classNameProp':_0x5a2abf(0xd6),'styleProp':'sourceStyle','rowClassName':_0x5a2abf(0xcb)}],'rows':this['_content'][_0x5a2abf(0x104)]((_0x3ae637,_0x3da6ef)=>{const _0x455a34=_0x5a2abf;return this[_0x455a34(0xba)][_0x455a34(0x13c)]['mutateForFilters'](_0x3ae637),_0x3ae637[_0x455a34(0x118)]=_0x3ae637[_0x455a34(0xa7)][_0x455a34(0xde)](',\x20')[_0x455a34(0xfe)](),{'name':_0x3ae637[_0x455a34(0xfb)],'type':_0x3ae637['_vType'],'cost':_0x3ae637[_0x455a34(0x13b)]||_0x3ae637[_0x455a34(0x16b)]?Parser[_0x455a34(0x131)](_0x3ae637,{'isShortForm':!![]})[_0x455a34(0x122)](/ +/g,'\u00a0'):'—','weight':Parser[_0x455a34(0x176)](_0x3ae637,!![])||'—','rarity':(_0x3ae637[_0x455a34(0x107)]||'Unknown')[_0x455a34(0x115)](),'attunement':_0x3ae637[_0x455a34(0xff)]==='No'?'':'×','source':_0x3ae637['source'],'sourceShort':Parser[_0x455a34(0xd3)](_0x3ae637[_0x455a34(0x14b)]),'sourceLong':Parser[_0x455a34(0x171)](_0x3ae637['source']),'sourceClassName':Parser['sourceJsonToColor'](_0x3ae637[_0x455a34(0x14b)]),'sourceStyle':BrewUtil2['sourceJsonToStylePart'](_0x3ae637[_0x455a34(0x14b)]),'ix':_0x3da6ef};})};}['_activateListeners_absorbListItems'](){const _0x3d807e=_0x513340;this[_0x3d807e(0xa9)][_0x3d807e(0x145)](this['_content'],{'fnGetName':_0x34d23b=>_0x34d23b[_0x3d807e(0xfb)],'fnGetValues':_0xadba2b=>({'source':_0xadba2b[_0x3d807e(0x14b)],'type':_0xadba2b[_0x3d807e(0x118)],'cost':_0xadba2b['value']||0x0,'rarity':_0xadba2b[_0x3d807e(0x107)],'attunement':_0xadba2b[_0x3d807e(0xff)]!=='No','weight':Parser['weightValueToNumber'](_0xadba2b[_0x3d807e(0xb3)]),'hash':UrlUtil['URL_TO_HASH_BUILDER'][this[_0x3d807e(0x134)]](_0xadba2b)}),'fnGetData':UtilList2[_0x3d807e(0xf7)],'fnBindListeners':_0x425961=>this[_0x3d807e(0xd1)]?UtilList2[_0x3d807e(0x173)](this[_0x3d807e(0xa9)],_0x425961):UtilList2[_0x3d807e(0xdd)](this[_0x3d807e(0xa9)],_0x425961)});}['_activateListeners_initRunButtonsAdditional'](){const _0x1471ce=_0x513340;this[_0x1471ce(0xae)]();}[_0x513340(0x162)](_0x9ac0e7,{isUseMods:isUseMods=![]}={}){if(!isUseMods)return _0x9ac0e7;return new Promise(_0x56d123=>{const _0x5e9220=_0x115f,_0x14606c=new ImportListItem[(_0x5e9220(0x11f))](_0x9ac0e7,_0x56d123,{'titleSearch':this['_titleSearch'],'isActor':!!this[_0x5e9220(0x121)]});_0x14606c[_0x5e9220(0x169)](!![]);});}async[_0x513340(0x146)](){const _0x2f9f26=_0x513340;await super[_0x2f9f26(0x146)](),this['_fluffLookup']={};const _0x1af700=await Vetools['pGetItemFluff']();_0x1af700[_0x2f9f26(0xf6)][_0x2f9f26(0xfa)](_0x271cc2=>(this['_fluffLookup'][_0x271cc2['source']]=this['_fluffLookup'][_0x271cc2[_0x2f9f26(0x14b)]]||{})[_0x271cc2['name']]=_0x271cc2),await Renderer[_0x2f9f26(0xe8)][_0x2f9f26(0x148)]();}[_0x513340(0x167)](){const _0x2179fe=_0x513340;return{...super[_0x2179fe(0x167)](),'rarity':{'label':_0x2179fe(0xee),'getter':_0x186622=>(!_0x186622['rarity']||_0x186622[_0x2179fe(0x107)]===_0x2179fe(0x12a)?_0x2179fe(0xd4):_0x186622[_0x2179fe(0x107)])['toTitleCase']()},'type':{'label':_0x2179fe(0xec),'getter':_0x2d0c6a=>{const _0x4d27c7=_0x2179fe;if(_0x2d0c6a[_0x4d27c7(0x108)])return Renderer[_0x4d27c7(0xe8)][_0x4d27c7(0x170)](_0x2d0c6a[_0x4d27c7(0x108)])[_0x4d27c7(0x115)]();else{if(_0x2d0c6a[_0x4d27c7(0x127)])return _0x2d0c6a[_0x4d27c7(0x127)];else{if(_0x2d0c6a[_0x4d27c7(0xe4)])return _0x4d27c7(0xc9);else{if(_0x2d0c6a[_0x4d27c7(0x11c)])return _0x4d27c7(0xbf);else return _0x4d27c7(0x149);}}}}}};}async[_0x513340(0x160)](_0x9e7fd5,_0x40157d){const _0x47df7d=_0x513340;_0x40157d=_0x40157d||{},console['log'](...LGT,_0x47df7d(0xab)+_0x9e7fd5['name']+'\x22\x20(from\x20\x22'+Parser['sourceJsonToAbv'](_0x9e7fd5[_0x47df7d(0x14b)])+'\x22)');const _0x43749=_0x9e7fd5[_0x47df7d(0x12c)]||MiscUtil[_0x47df7d(0x109)](this['_fluffLookup'],_0x9e7fd5[_0x47df7d(0x14b)],_0x9e7fd5['name']),_0x21565a={'fluff':_0x43749};if(_0x40157d[_0x47df7d(0xf4)]!=null)_0x21565a['quantity']=_0x40157d[_0x47df7d(0xf4)];await this[_0x47df7d(0xf0)](_0x9e7fd5);if(_0x40157d[_0x47df7d(0x16f)])return new ImportSummary({'status':UtilApplications[_0x47df7d(0x111)],'imported':(await this['_pImportEntry_pImportToDataOnly'](_0x9e7fd5,_0x40157d,_0x21565a))[_0x47df7d(0x104)](_0x4fa582=>new ImportedDocument({'document':_0x4fa582,'actor':this[_0x47df7d(0x121)]}))});if(_0x40157d[_0x47df7d(0x114)])return this[_0x47df7d(0x10f)](_0x9e7fd5,_0x40157d,_0x21565a);if(this['_actor'])return this[_0x47df7d(0xea)](_0x9e7fd5,_0x40157d,_0x21565a);return this[_0x47df7d(0x10f)](_0x9e7fd5,_0x40157d,_0x21565a);}async[_0x513340(0xf0)](_0x36321d){const _0x1b76a2=_0x513340;if(BrewUtil2[_0x1b76a2(0xc1)](_0x36321d[_0x1b76a2(0x14b)]))return;if(SourceUtil[_0x1b76a2(0xe9)](_0x36321d['source']))return;if(!Vetools[_0x1b76a2(0x10c)][_0x36321d[_0x1b76a2(0x14b)]])return;const _0x2bb2b4=DataUtil[_0x1b76a2(0xfc)][_0x1b76a2(0x14a)](Vetools['HOMEBREW_INDEX__SOURCE'][_0x36321d['source']],Config[_0x1b76a2(0x109)]('import',_0x1b76a2(0xb1)));await BrewUtil2['pAddBrewFromMemory'](await DataUtil[_0x1b76a2(0xa2)](_0x2bb2b4)),await Renderer[_0x1b76a2(0xe8)][_0x1b76a2(0x101)](await DataUtil[_0x1b76a2(0x142)](_0x2bb2b4));}async[_0x513340(0xcc)](_0x2c1370,_0x5e260b,_0x20775f){const _0x4538d=_0x513340;if(!this[_0x4538d(0x121)]||!this['_isPackSplitImport'](_0x2c1370))return[await DataConverterItem[_0x4538d(0xe2)](_0x2c1370)];const _0x491242=await this[_0x4538d(0xad)](_0x2c1370,_0x5e260b,_0x20775f);return _0x491242[_0x4538d(0x104)](({itemData:_0x360ed1})=>_0x360ed1);}[_0x513340(0x14e)](_0x2bd94a){const _0x195557=_0x513340;return _0x2bd94a['packContents']&&Config[_0x195557(0x109)](this[_0x195557(0xeb)],_0x195557(0xd8))&&(!_0x2bd94a[_0x195557(0x16c)]||Config[_0x195557(0x109)](this['_configGroup'],_0x195557(0xc6)));}async['_pImportEntry_pImportToActor'](_0x235bfa,_0x453ea4,_0xf288c){const _0x45322b=_0x513340;_0xf288c={..._0xf288c,'isActorItem':!![]},_0xf288c['filterValues']=_0x453ea4[_0x45322b(0x133)],_0xf288c[_0x45322b(0xbd)]=this['_pImportEntry_getSheetItemsAmmo'](_0x235bfa);let _0x339904;if(this[_0x45322b(0x14e)](_0x235bfa))_0x339904=await this[_0x45322b(0x139)](_0x235bfa,_0x453ea4,_0xf288c);else{const _0x5d19a8=await DataConverterItem['pGetItemItem'](_0x235bfa,_0xf288c),_0x33b520=await this[_0x45322b(0x10d)]({'item':_0x235bfa,'itemData':_0x5d19a8});_0x339904=[_0x33b520];}if(this[_0x45322b(0x121)][_0x45322b(0x17b)])this[_0x45322b(0x121)][_0x45322b(0xd5)]['render']();return new ImportSummary({'status':UtilApplications[_0x45322b(0xe7)],'imported':_0x339904[_0x45322b(0x104)](_0x1ee6a8=>new ImportedDocument({'name':_0x235bfa[_0x45322b(0xfb)],'actor':this[_0x45322b(0x121)],'embeddedDocument':_0x1ee6a8}))});}async[_0x513340(0xad)](_0x3e8e92,_0x64ca63,_0x557cef){const _0x522e9e=_0x513340,_0x1bb65e=[],_0x3ea7d4=await Promise[_0x522e9e(0xef)](_0x3e8e92['packContents']['map'](async _0x1b6a4e=>{const _0x294b30=_0x522e9e,_0x1f7bdc=_0x1b6a4e['quantity']||0x1;if(_0x1b6a4e['item']||typeof _0x1b6a4e===_0x294b30(0x13a)){let [_0x194014,_0x53ffb4]=(_0x1b6a4e[_0x294b30(0xe8)]||_0x1b6a4e)[_0x294b30(0xca)]('|');if(!_0x53ffb4)_0x53ffb4=SRC_DMG;const _0x52f4f6=UrlUtil[_0x294b30(0xa5)][UrlUtil[_0x294b30(0xc5)]]({'name':_0x194014,'source':_0x53ffb4}),_0x49c10c=await Renderer[_0x294b30(0x17c)][_0x294b30(0xd9)](UrlUtil[_0x294b30(0xc5)],_0x53ffb4,_0x52f4f6);return{'item':_0x49c10c,'itemData':await DataConverterItem[_0x294b30(0xe2)](_0x49c10c,{'filterValues':_0x64ca63[_0x294b30(0x133)],..._0x557cef,'quantity':_0x1f7bdc})};}else{if(_0x1b6a4e[_0x294b30(0x161)]){const _0x476c40={'name':_0x1b6a4e['special'][_0x294b30(0x115)](),'type':'G','source':_0x3e8e92[_0x294b30(0x14b)],'page':_0x3e8e92['page'],'srd':_0x3e8e92[_0x294b30(0x143)]};return Renderer[_0x294b30(0xe8)][_0x294b30(0xf3)](_0x476c40),{'item':_0x476c40,'itemData':await DataConverterItem[_0x294b30(0xe2)](_0x476c40,{'filterValues':_0x64ca63[_0x294b30(0x133)],..._0x557cef,'quantity':_0x1f7bdc})};}else _0x1bb65e[_0x294b30(0x116)](_0x294b30(0x15f)+JSON[_0x294b30(0x117)](_0x1b6a4e)+'\x22');}}));return _0x1bb65e[_0x522e9e(0xa8)]&&(ui[_0x522e9e(0x13d)][_0x522e9e(0x10e)](_0x522e9e(0xc8)+_0x3e8e92[_0x522e9e(0xfb)]+'\x22\x20(from\x20\x22'+Parser['sourceJsonToAbv'](_0x3e8e92['source'])+'\x22)\x20could\x20not\x20be\x20broken\x20down\x20into\x20constituent\x20items!\x20'+VeCt[_0x522e9e(0x12e)]),console[_0x522e9e(0x10e)](...LGT,_0x522e9e(0x11b)+_0x3e8e92['name']+'\x20('+_0x3e8e92[_0x522e9e(0x14b)]+_0x522e9e(0x16e)+_0x1bb65e[_0x522e9e(0xde)](';\x20'))),_0x3ea7d4['filter'](Boolean);}async[_0x513340(0x139)](_0x1b46db,_0x4aac38,_0xeb62b7){const _0x839b6=_0x513340,_0x46de76=await this['_pGetPackItemMetas'](_0x1b46db,_0x4aac38,_0xeb62b7);return _0x46de76['pSerialAwaitMap'](({item:_0x16b397,itemData:_0x458fe4})=>this[_0x839b6(0x10d)]({'item':_0x16b397,'itemData':_0x458fe4}));}async[_0x513340(0x10d)]({item:_0xe0251f,itemData:_0x3beef4}){const _0x4696b8=_0x513340,_0x449fef=await this[_0x4696b8(0x140)]({'item':_0xe0251f,'itemData':_0x3beef4});return this[_0x4696b8(0x123)]({'itemData':_0x3beef4,'embeddedDocument':_0x449fef});}async['_pImportEntry_pImportToActor_pAddOrUpdateItem']({item:_0x6e6817,itemData:_0x227616}){const _0x43d55c=_0x513340,_0x1be608=this[_0x43d55c(0xaf)]({'item':_0x6e6817,'itemData':_0x227616});if(!_0x1be608)return(await UtilActors[_0x43d55c(0x157)](this['_actor'],[_0x227616]))[0x0]['document'];const _0x4f2017={'_id':_0x1be608['id'],'data':{'quantity':(_0x1be608[_0x43d55c(0xbc)][_0x43d55c(0xbc)][_0x43d55c(0xf4)]||0x0)+(_0x227616[_0x43d55c(0xbc)][_0x43d55c(0xf4)]||0x0)}};return(await UtilDocuments[_0x43d55c(0xbe)](this[_0x43d55c(0x121)],[_0x4f2017],{'ClsEmbed':Item}))[0x0][_0x43d55c(0x12d)];}[_0x513340(0xaf)]({item:_0x2011e1,itemData:_0x2cc064}){const _0x2c9e97=_0x513340;if(Config[_0x2c9e97(0x109)]('importItem',_0x2c9e97(0x10a))===ConfigConsts[_0x2c9e97(0x14f)])return null;const _0x1ce260=this[_0x2c9e97(0x121)][_0x2c9e97(0x174)][_0x2c9e97(0x103)]['find'](_0x557bff=>{const _0x307959=_0x2c9e97;if(_0x557bff[_0x307959(0x108)]!==_0x2cc064[_0x307959(0x108)])return;const _0x2cb0fe=!Config['get'](_0x307959(0xf5),'isStrictMatching')||(UtilDataConverter[_0x307959(0xe3)](_0x557bff)[_0x307959(0x14b)]||'')[_0x307959(0x17d)]()===(UtilDataConverter[_0x307959(0xe3)](_0x2cc064)[_0x307959(0x14b)]||'')['toLowerCase']();if(!_0x2cb0fe)return![];if(_0x557bff[_0x307959(0xfb)][_0x307959(0x17d)]()[_0x307959(0x16d)]()===_0x2cc064[_0x307959(0xfb)][_0x307959(0x17d)]()[_0x307959(0x16d)]())return!![];return DataConverterItem[_0x307959(0x12f)](_0x2011e1,{'isStrict':!![]})[_0x307959(0xc3)](_0x36ae4b=>_0x36ae4b[_0x307959(0x17d)]()['trim']()===_0x557bff['name'][_0x307959(0x17d)]()['trim']());});if(!_0x1ce260)return null;if(Config['get'](_0x2c9e97(0xa4),_0x2c9e97(0x10a))===ConfigConsts[_0x2c9e97(0x14c)])return _0x1ce260;if(Config[_0x2c9e97(0x109)](_0x2c9e97(0xa4),_0x2c9e97(0x10a))===ConfigConsts[_0x2c9e97(0xd2)]&&(this[_0x2c9e97(0x172)]({'itemData':_0x2cc064})||this[_0x2c9e97(0x175)]({'itemData':_0x2cc064})))return _0x1ce260;return null;}[_0x513340(0x172)]({itemData:_0x454d83}){const _0xc4bc25=_0x513340,_0x4b5051=new Set((Config[_0xc4bc25(0x109)](this[_0xc4bc25(0xeb)],'throwables')||[])[_0xc4bc25(0x104)](_0x2964bd=>_0x2964bd[_0xc4bc25(0x16d)]()[_0xc4bc25(0x17d)]()));return _0x4b5051[_0xc4bc25(0xb6)]((_0x454d83['name']||'')[_0xc4bc25(0x17d)]()[_0xc4bc25(0x16d)]());}[_0x513340(0x175)]({itemData:_0xd60832}){const _0x13c7d=_0x513340;return new Set(DataConverterItem[_0x13c7d(0xc4)])[_0x13c7d(0xb6)](_0xd60832[_0x13c7d(0x108)]);}async[_0x513340(0x123)]({itemData:_0x37150f,embeddedDocument:_0xc97824}){const _0x27e882=_0x513340;if(!_0xc97824)return;return this[_0x27e882(0x172)]({'itemData':_0x37150f})&&await UtilDocuments[_0x27e882(0xbe)](this['_actor'],[{'_id':_0xc97824['id'],'data':{'consume':{'type':_0x27e882(0x158),'target':_0xc97824['id'],'amount':0x1}}}],{'propData':_0x27e882(0x174),'ClsEmbed':Item}),_0xc97824;}[_0x513340(0xe5)](_0xf67a79,_0x57f488){const _0x5792a6=_0x513340;return DataConverterItem[_0x5792a6(0xe2)](_0xf67a79,_0x57f488);}[_0x513340(0x178)](_0x478fd3){const _0x2747f6=_0x513340;if(!_0x478fd3[_0x2747f6(0x15a)])return null;if(!this['_actor'])return null;return this[_0x2747f6(0x121)]['items']['filter'](_0x1f30de=>_0x1f30de[_0x2747f6(0x108)]===_0x2747f6(0x152)&&_0x1f30de[_0x2747f6(0xbc)][_0x2747f6(0xbc)][_0x2747f6(0x129)]===_0x2747f6(0x158));}static['sortEntries'](_0x325bdf,_0x248fe8){const _0xb437ff=_0x513340;if(_0x325bdf['ammoType']&&!_0x248fe8['ammoType'])return 0x1;if(!_0x325bdf['ammoType']&&_0x248fe8[_0xb437ff(0x15a)])return-0x1;return SortUtil[_0xb437ff(0x15d)](_0x325bdf[_0xb437ff(0xfb)],_0x248fe8[_0xb437ff(0xfb)])||SortUtil[_0xb437ff(0x15d)](Parser[_0xb437ff(0x171)](_0x325bdf['source']),Parser[_0xb437ff(0x171)](_0x248fe8[_0xb437ff(0x14b)]));}async[_0x513340(0x153)](_0x11875e,_0xbefa77){const _0x1ccfdc=_0x513340;_0xbefa77=_0xbefa77||{},console[_0x1ccfdc(0xaa)](...LGT,_0x1ccfdc(0x124)+Parser[_0x1ccfdc(0x126)](_0x11875e)+'\x22');const _0x2ae1ae=await DataConverterItem['pGetCurrencyItem'](_0x11875e,{'isAddPermission':!this[_0x1ccfdc(0x121)]}),_0x49425f={'name':_0x1ccfdc(0xfd),'source':VeCt[_0x1ccfdc(0x150)]};if(_0xbefa77[_0x1ccfdc(0x114)])return this['_pImportEntry_pImportToDirectoryGeneric'](_0x49425f,_0xbefa77,null,{'docData':_0x2ae1ae,'isSkipDuplicateHandling':!![]});if(this[_0x1ccfdc(0x121)])return this[_0x1ccfdc(0xea)](_0x49425f,_0xbefa77,null,{'docData':_0x2ae1ae});return this[_0x1ccfdc(0x10f)](_0x49425f,_0xbefa77,null,{'docData':_0x2ae1ae,'isSkipDuplicateHandling':!![]});}static[_0x513340(0x136)](){const _0x3d5f9b=_0x513340;Hooks['on'](_0x3d5f9b(0x113),(_0x34b5d1,_0x2d8637,_0x5a1c64,_0x3f8d11)=>{const _0x3253bb=_0x3d5f9b;if(_0x34b5d1['parent']?.[_0x3253bb(0xe1)]!==_0x3253bb(0x163))return;const _0x4f01a1=_0x2d8637[_0x3253bb(0x120)]?.[SharedConsts[_0x3253bb(0xdc)]]||_0x2d8637[_0x3253bb(0x120)]?.[SharedConsts[_0x3253bb(0x17e)]];if(_0x4f01a1?.[_0x3253bb(0x108)]!==DataConverterItem[_0x3253bb(0x112)]||!_0x4f01a1?.[_0x3253bb(0xf2)])return;const _0x34dbd8=_0x34b5d1[_0x3253bb(0xed)];return UtilActors[_0x3253bb(0x110)]({'currency':_0x4f01a1[_0x3253bb(0xf2)],'actor':_0x34dbd8})['then'](null)[_0x3253bb(0x147)](_0x21fb2b=>{const _0x1d15e2=_0x3253bb;ui[_0x1d15e2(0x13d)][_0x1d15e2(0x10e)](_0x1d15e2(0x15e)+VeCt[_0x1d15e2(0xb5)]);throw _0x21fb2b;}),![];});}}ImportListItem[_0x513340(0x11f)]=class extends ImportCustomizer{constructor(_0x33f1ae,_0x48136a,_0x4a0022){const _0x5bd803=_0x513340;super(_0x33f1ae,_0x48136a,{..._0x4a0022,'title':_0x5bd803(0x168),'template':SharedConsts[_0x5bd803(0x165)]+_0x5bd803(0x164)});}[_0x513340(0xd7)](){const _0x15b423=_0x513340;return{...super[_0x15b423(0xd7)](),'rows':this['_dataList'][_0x15b423(0x104)]((_0xc34051,_0x4fa40d)=>({'name':_0xc34051[_0x15b423(0xfb)],'source':_0xc34051[_0x15b423(0x14b)],'sourceShort':Parser[_0x15b423(0xd3)](_0xc34051['source']),'sourceLong':Parser['sourceJsonToFull'](_0xc34051[_0x15b423(0x14b)]),'sourceClassName':Parser[_0x15b423(0xdb)](_0xc34051[_0x15b423(0x14b)]),'sourceStyle':BrewUtil2[_0x15b423(0x13e)](_0xc34051[_0x15b423(0x14b)]),'foundryTypes':DataConverterItem[_0x15b423(0xa3)]['map']((_0x1c5f7d,_0x3d5c24)=>({'ix':_0x3d5c24,'type':_0x1c5f7d,'displayName':game['i18n'][_0x15b423(0x125)](_0x15b423(0x138)+_0x1c5f7d[_0x15b423(0xb9)]())})),'ix':_0x4fa40d}))};}[_0x513340(0x141)]({$html:_0x2350f8}){const _0x18483b=_0x513340;this[_0x18483b(0xa9)]=new List({'$iptSearch':_0x2350f8[_0x18483b(0x11a)](_0x18483b(0xcd)),'$wrpList':_0x2350f8[_0x18483b(0x11a)](_0x18483b(0x130)),'valueNames':[_0x18483b(0xfb),_0x18483b(0x14b),'ix']}),this[_0x18483b(0xa9)][_0x18483b(0x145)](this[_0x18483b(0xce)],{'fnGetName':_0x49100b=>_0x49100b[_0x18483b(0xfb)],'fnGetValues':_0x373b56=>({'source':_0x373b56[_0x18483b(0x14b)]}),'fnGetData':_0x472d4a=>{const _0x5374bd=_0x18483b,_0x2063bb=$(_0x472d4a[_0x5374bd(0x179)]);return{'$selFoundryType':_0x2063bb['find'](_0x5374bd(0xe0))};}}),this['_list'][_0x18483b(0x14d)]();}[_0x513340(0x144)]({$html:_0x35d105,$wrpBtnsSort:_0x37d5ba}){const _0x53653b=_0x513340;this[_0x53653b(0xac)]=_0x35d105[_0x53653b(0x11a)](_0x53653b(0xf1))[_0x53653b(0x17a)](()=>{const _0xd85474=_0x53653b;_0x35d105[_0xd85474(0x11a)](_0xd85474(0xcd))[_0xd85474(0xe6)]('');if(this[_0xd85474(0xa9)])this[_0xd85474(0xa9)][_0xd85474(0x106)]();}),_0x35d105[_0x53653b(0x11a)](_0x53653b(0x151))[_0x53653b(0x17a)](async()=>{const _0x75dca0=_0x53653b,_0x186630=this[_0x75dca0(0xa9)][_0x75dca0(0x174)][_0x75dca0(0x104)](_0x3272db=>{const _0x4177cf=_0x75dca0,_0x4982c1=Number(_0x3272db['data']['$selFoundryType'][_0x4177cf(0xe6)]());if(!~_0x4982c1)return this[_0x4177cf(0xce)][_0x3272db['ix']];const _0x19a63f=MiscUtil[_0x4177cf(0x17f)](this[_0x4177cf(0xce)][_0x3272db['ix']]);return _0x19a63f[_0x4177cf(0x15c)]=DataConverterItem[_0x4177cf(0xa3)][_0x4982c1],_0x19a63f;});this['_resolve'](_0x186630),this[_0x75dca0(0xc0)]();});}};export{ImportListItem};