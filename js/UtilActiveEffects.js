const _0xd41dd7=_0x25d3;(function(_0x234717,_0x100f90){const _0xcaf183=_0x25d3,_0x5e2407=_0x234717();while(!![]){try{const _0x4ffe36=parseInt(_0xcaf183(0xe2))/0x1+-parseInt(_0xcaf183(0x126))/0x2*(-parseInt(_0xcaf183(0xfc))/0x3)+parseInt(_0xcaf183(0xf2))/0x4*(parseInt(_0xcaf183(0xdb))/0x5)+parseInt(_0xcaf183(0xf8))/0x6*(parseInt(_0xcaf183(0xee))/0x7)+-parseInt(_0xcaf183(0x119))/0x8+-parseInt(_0xcaf183(0xdc))/0x9*(parseInt(_0xcaf183(0x12e))/0xa)+parseInt(_0xcaf183(0x108))/0xb*(-parseInt(_0xcaf183(0x118))/0xc);if(_0x4ffe36===_0x100f90)break;else _0x5e2407['push'](_0x5e2407['shift']());}catch(_0x1493ff){_0x5e2407['push'](_0x5e2407['shift']());}}}(_0x5203,0x4ba4e));import{SharedConsts}from'../shared/SharedConsts.js';class ActiveEffectMeta{constructor(_0xb4303b,_0x4218dc,_0x14ee99){const _0xfb2a30=_0x25d3;this[_0xfb2a30(0x131)]=_0xb4303b,this['mode']=_0x4218dc,this[_0xfb2a30(0x12c)]=_0x14ee99;}get[_0xd41dd7(0xd8)](){const _0x2c0ef7=_0xd41dd7;return typeof this[_0x2c0ef7(0x12c)];}}class UtilActiveEffects{static [_0xd41dd7(0x124)]=[_0xd41dd7(0xdd),_0xd41dd7(0xda),'data.attributes.ac.dex','data.attributes.ac.shield',_0xd41dd7(0xfb),_0xd41dd7(0xe0)];static[_0xd41dd7(0x10a)](){const _0x2ee762=_0xd41dd7;UtilActiveEffects[_0x2ee762(0x11e)][_0x2ee762(0x102)](new ActiveEffectMeta('data.attributes.prof',CONST[_0x2ee762(0xf6)]['OVERRIDE'],0x1),new ActiveEffectMeta(_0x2ee762(0x133),CONST[_0x2ee762(0xf6)][_0x2ee762(0xe1)],''),new ActiveEffectMeta(_0x2ee762(0xea),CONST[_0x2ee762(0xf6)][_0x2ee762(0xe1)],''),new ActiveEffectMeta(_0x2ee762(0xd7),CONST[_0x2ee762(0xf6)]['OVERRIDE'],''),...Object['entries'](CONFIG?.[_0x2ee762(0x10f)]?.[_0x2ee762(0x105)]||{})[_0x2ee762(0xd4)](([_0x50c582,_0x396569])=>new ActiveEffectMeta(_0x2ee762(0xd3)+_0x50c582,CONST[_0x2ee762(0xf6)][_0x2ee762(0xe1)],_0x396569[_0x2ee762(0xcf)]!=null?MiscUtil[_0x2ee762(0x129)](_0x396569['placeholder']):_0x396569['type']())),...Object[_0x2ee762(0x12a)](CONFIG?.[_0x2ee762(0x10f)]?.[_0x2ee762(0x109)]||{})[_0x2ee762(0xd4)](_0x1bf6f7=>[new ActiveEffectMeta(_0x2ee762(0xd6)+_0x1bf6f7+'.attack',CONST[_0x2ee762(0xf6)]['OVERRIDE'],''),new ActiveEffectMeta(_0x2ee762(0xd6)+_0x1bf6f7+_0x2ee762(0x107),CONST[_0x2ee762(0xf6)][_0x2ee762(0xe1)],'')])[_0x2ee762(0x110)](),...this[_0x2ee762(0x124)]['map'](_0x2b8e80=>new ActiveEffectMeta(_0x2b8e80,CONST['ACTIVE_EFFECT_MODES'][_0x2ee762(0xe1)],'')));}static[_0xd41dd7(0xf4)](_0x5fcca2,_0x8739c7){const _0x1f55f2=_0xd41dd7;_0x8739c7=_0x8739c7||{};let _0xff0917;if(_0x8739c7[_0x1f55f2(0xe5)])_0xff0917=game[_0x1f55f2(0x122)][_0x1f55f2(0xd1)]['Item'];else{if(_0x8739c7[_0x1f55f2(0xf1)])_0xff0917=game[_0x1f55f2(0x122)]['model']['Actor'];else throw new Error('Unhandled\x20effect\x20mode,\x20was\x20neither\x20an\x20item\x20effect\x20nor\x20an\x20actor\x20effect!');}const _0x3b3d6a=_0xff0917[_0x5fcca2[_0x1f55f2(0x100)][_0x1f55f2(0xd2)]],_0x25d142=Object[_0x1f55f2(0xd5)](foundry[_0x1f55f2(0x113)][_0x1f55f2(0x120)](_0x3b3d6a))[_0x1f55f2(0xd4)](([_0x4a6c98,_0x343df5])=>new ActiveEffectMeta('data.'+_0x4a6c98,CONST[_0x1f55f2(0xf6)][_0x1f55f2(0xe1)],_0x343df5));if(_0x8739c7[_0x1f55f2(0xe5)])return _0x25d142;return[..._0x25d142,...UtilActiveEffects[_0x1f55f2(0x11e)]][_0x1f55f2(0xf3)](_0x448522=>_0x448522['path'])[_0x1f55f2(0xfa)](SortUtil[_0x1f55f2(0x106)][_0x1f55f2(0x111)](null,_0x1f55f2(0x131)));}static[_0xd41dd7(0xe3)](_0x159703,_0x581250){const _0x5a8a14=_0xd41dd7,_0x38a294=this[_0x5a8a14(0xf4)](_0x159703,_0x581250),_0x29836a={};return _0x38a294[_0x5a8a14(0xf7)](_0x4fa7d8=>_0x29836a[_0x4fa7d8['path']]=_0x4fa7d8),_0x29836a;}static[_0xd41dd7(0xf5)](_0x4bc298,_0x546332){const _0x5a7edf=_0xd41dd7;if(!_0x546332)return undefined;_0x546332=this[_0x5a7edf(0x127)](_0x546332);if(!_0x4bc298[_0x546332])return undefined;const _0x1fc51c=_0x4bc298[_0x546332];if(_0x1fc51c[_0x5a7edf(0x12c)]===undefined)return _0x5a7edf(0xcc);if(_0x1fc51c[_0x5a7edf(0x12c)]===null)return _0x5a7edf(0x117);if(_0x1fc51c[_0x5a7edf(0x12c)]instanceof Array)return _0x5a7edf(0x11f);return typeof _0x1fc51c[_0x5a7edf(0x12c)];}static['getActiveEffectDefault'](_0x31bc2b,_0x2d6137){const _0x2a09c4=_0xd41dd7;if(!_0x2d6137)return undefined;return _0x2d6137=this[_0x2a09c4(0x127)](_0x2d6137),_0x31bc2b[_0x2d6137]?.[_0x2a09c4(0x12c)];}static[_0xd41dd7(0x104)](_0x1a5de7,{actor:actor=null,sheetItem:sheetItem=null,parentName:parentName='',additionalData:additionalData=null,img:img=null}={}){const _0x21ab03=_0xd41dd7;if(!_0x1a5de7||!_0x1a5de7[_0x21ab03(0x132)])return[];const _0x4554b5=[];for(const _0x39f277 of _0x1a5de7){if(!_0x39f277[_0x21ab03(0x10d)]||!_0x39f277[_0x21ab03(0x10d)]['length'])continue;const _0x23e297=MiscUtil['copy'](_0x39f277);['name','priority',_0x21ab03(0x128),_0x21ab03(0xce),_0x21ab03(0x10d)]['forEach'](_0x4a0b40=>delete _0x23e297[_0x4a0b40]);const _0x403f12=UtilActiveEffects[_0x21ab03(0xed)]({'label':_0x39f277[_0x21ab03(0xde)]??parentName,'priority':Math['max'](..._0x39f277[_0x21ab03(0x10d)][_0x21ab03(0xd4)](_0x4e530d=>UtilActiveEffects[_0x21ab03(0x11d)](UtilActiveEffects[_0x21ab03(0x11b)]({'mode':_0x4e530d[_0x21ab03(0xfe)]})))),'icon':img??sheetItem?.[_0x21ab03(0xef)]??actor?.['data']?.[_0x21ab03(0xef)]??actor?.['data']?.[_0x21ab03(0xe8)]?.[_0x21ab03(0x10b)],'disabled':!!_0x39f277[_0x21ab03(0xce)]});if(actor&&sheetItem)_0x403f12[_0x21ab03(0x114)]=_0x21ab03(0xeb)+actor['id']+_0x21ab03(0x11c)+sheetItem['id'];_0x403f12['changes']=_0x403f12[_0x21ab03(0x10d)]||[],_0x39f277[_0x21ab03(0x10d)][_0x21ab03(0xf7)](_0x1c8304=>{const _0x148cf4=_0x21ab03,_0x3f83bf=UtilActiveEffects[_0x148cf4(0x11b)](_0x1c8304[_0x148cf4(0xfe)]),_0x43a36b=this[_0x148cf4(0x116)]({'rawKey':_0x1c8304['key'],'additionalData':additionalData});_0x43a36b['forEach'](_0x5fca67=>{const _0x440eb6=_0x148cf4;_0x403f12[_0x440eb6(0x10d)][_0x440eb6(0x102)]({'key':_0x5fca67,'mode':_0x3f83bf,'value':_0x1c8304[_0x440eb6(0xcd)],'priority':UtilActiveEffects[_0x440eb6(0x11d)]({'mode':_0x3f83bf,'rawPriority':_0x1c8304['priority']})});});}),Object[_0x21ab03(0xd5)](_0x23e297)[_0x21ab03(0xf7)](([_0x5d8fb4,_0x123e1d])=>{_0x403f12[_0x5d8fb4]=_0x123e1d;});if(_0x403f12[_0x21ab03(0x10d)]['length'])_0x4554b5[_0x21ab03(0x102)](_0x403f12);}return _0x4554b5;}static[_0xd41dd7(0x116)]({rawKey:_0x49a44c,additionalData:_0x2bffac}){const _0x272f60=_0xd41dd7;if(!_0x2bffac)return[_0x49a44c];const _0x57de65=_0x49a44c['split'](/(<\$[^$]+\$>)/g)[_0x272f60(0xd4)](_0x217147=>_0x217147['trim']())['filter'](Boolean);if(_0x57de65['length']===0x1)return[_0x49a44c];const _0x1a78bc=_0x57de65[_0x272f60(0xd4)](_0x56d0e2=>{const _0x1a9f21=_0x272f60;if(/^<\$[^$]+\$>$/[_0x1a9f21(0x10e)](_0x56d0e2))return _0x56d0e2;return _0x56d0e2[_0x1a9f21(0xe9)]('.')[_0x1a9f21(0xd4)](_0x51afa3=>_0x51afa3[_0x1a9f21(0xd9)]())[_0x1a9f21(0x112)](Boolean);})[_0x272f60(0x110)](),_0x227e60=[];return this['_getExpandedEffects_recurseKey']({'additionalData':_0x2bffac,'out':_0x227e60,'stack':[],'keyParts':_0x1a78bc,'depth':0x0}),_0x227e60;}static['_getExpandedEffects_recurseKey']({additionalData:_0xe64c9,out:_0x7c20c0,stack:_0x43269,keyParts:_0x514cd3,depth:_0x236566}){const _0x12225a=_0xd41dd7,_0x16c03b=_0x514cd3[_0x236566],_0x309dde=/^<\$([^$]+)\$>$/[_0x12225a(0x10c)](_0x16c03b);if(_0x309dde){const _0x3d708c=[];let _0x40cb42=null,_0x37b23c=_0x309dde[0x1];const _0x4f7870=/^([^(]+)\((.*?)\)$/['exec'](_0x37b23c);if(_0x4f7870){const [,_0x2b25c4,_0x57aa46]=_0x4f7870;_0x40cb42=_0x2b25c4,_0x37b23c=_0x57aa46;}const _0x11bcb0=_0x37b23c[_0x12225a(0xe9)]('.')[_0x12225a(0xd4)](_0x2e8261=>_0x2e8261['trim']())[_0x12225a(0x112)](Boolean);this[_0x12225a(0xe4)]({'additionalData':_0xe64c9,'out':_0x3d708c,'stack':[],'tokens':_0x11bcb0,'depth':0x0});let _0x3f2e06=_0x3d708c[_0x12225a(0xd4)](_0x4c9db2=>MiscUtil['get'](_0xe64c9,..._0x4c9db2[_0x12225a(0xe9)]('.')));if(_0x3f2e06[_0x12225a(0xe7)](_0x4f6f9f=>_0x4f6f9f==null))return;if(_0x40cb42)_0x3f2e06=_0x3f2e06['map'](_0x558f19=>this[_0x12225a(0x12b)]({'fn':_0x40cb42,'additionalDataValue':_0x558f19}))[_0x12225a(0x110)]();_0x3f2e06['forEach'](_0x363dbd=>{const _0x5b484b=_0x12225a,_0xbba213=MiscUtil[_0x5b484b(0x129)](_0x514cd3);_0xbba213[_0x236566]=_0x363dbd,this[_0x5b484b(0x125)]({'additionalData':_0xe64c9,'out':_0x7c20c0,'stack':_0x43269,'keyParts':_0xbba213,'depth':_0x236566});});}else{if(_0x236566===_0x514cd3[_0x12225a(0x132)]-0x1){_0x7c20c0['push']([..._0x43269,_0x16c03b][_0x12225a(0x12d)]('.'));return;}_0x43269[_0x12225a(0x102)](_0x16c03b),this[_0x12225a(0x125)]({'additionalData':_0xe64c9,'out':_0x7c20c0,'stack':_0x43269,'keyParts':_0x514cd3,'depth':_0x236566+0x1}),_0x43269['pop']();}}static['_getExpandedEffects_getKeyVariableFunctionOutput']({fn:_0x4edca6,additionalDataValue:_0x166724}){const _0x40296b=_0xd41dd7;switch(_0x4edca6){case'keys':return Object[_0x40296b(0x12a)](_0x166724??{});default:return _0x166724[_0x4edca6]();}}static[_0xd41dd7(0xe4)]({additionalData:_0x3d54e7,out:_0x5c8683,stack:_0x3f5f37,tokens:_0x5e06f2,depth:_0x1e97d0}){const _0x4727a9=_0xd41dd7,_0xe55475=_0x5e06f2[_0x1e97d0];if(_0xe55475[_0x4727a9(0x12f)]('()')){const _0x5a9ce5=_0xe55475[_0x4727a9(0xec)](0x0,-0x2),_0x3375bb=this[_0x4727a9(0x101)]({'fn':_0x5a9ce5,'additionalData':_0x3d54e7,'stack':_0x3f5f37});if(_0x3375bb==null)return;const _0x54cced=_0x3375bb instanceof Array?_0x3375bb:[_0x3375bb];_0x54cced[_0x4727a9(0xf7)](_0x1024db=>{const _0xe0735b=_0x4727a9,_0x4b94b6=MiscUtil['copy'](_0x5e06f2);_0x4b94b6[_0x1e97d0]=_0x1024db,this[_0xe0735b(0xe4)]({'additionalData':_0x3d54e7,'out':_0x5c8683,'stack':_0x3f5f37,'tokens':_0x4b94b6,'depth':_0x1e97d0});});}else{if(_0x1e97d0===_0x5e06f2[_0x4727a9(0x132)]-0x1){_0x5c8683[_0x4727a9(0x102)]([..._0x3f5f37,_0xe55475][_0x4727a9(0x12d)]('.'));return;}_0x3f5f37[_0x4727a9(0x102)](_0xe55475),this[_0x4727a9(0xe4)]({'additionalData':_0x3d54e7,'out':_0x5c8683,'stack':_0x3f5f37,'tokens':_0x5e06f2,'depth':_0x1e97d0+0x1}),_0x3f5f37[_0x4727a9(0x123)]();}}static[_0xd41dd7(0x101)]({fn:_0xedfa97,additionalData:_0x52de7e,stack:_0x33395e}){const _0x54318c=_0xd41dd7,_0x327c55=MiscUtil['get'](_0x52de7e,..._0x33395e);switch(_0xedfa97){case _0x54318c(0x12a):return Object[_0x54318c(0x12a)](_0x327c55??{});default:return _0x327c55[_0xedfa97]();}}static['getGenericEffect']({label:label='',icon:icon=_0xd41dd7(0xe6),disabled:disabled=![],transfer:transfer=!![],key:key='',value:value='',mode:mode=CONST[_0xd41dd7(0xf6)][_0xd41dd7(0xe1)],priority:priority=null,durationSeconds:durationSeconds=null,durationRounds:durationRounds=null,durationTurns:durationTurns=null,changes:changes=null,originActor:originActor=null,originActorItem:originActorItem=null,flags:flags=null}={}){const _0x1e414d=_0xd41dd7;if(changes&&(key||value))throw new Error(_0x1e414d(0xdf));const _0x44ec6d=key||value?this[_0x1e414d(0xff)]({'key':key,'value':value,'mode':mode,'priority':priority}):null;return flags=flags||{},{'label':label,'icon':icon,'changes':changes??[_0x44ec6d][_0x1e414d(0x112)](Boolean),'disabled':disabled,'duration':{'startTime':null,'seconds':durationSeconds,'rounds':durationRounds,'turns':durationTurns,'startRound':null,'startTurn':null},'origin':originActor?originActorItem?_0x1e414d(0xeb)+originActor['id']+_0x1e414d(0x11c)+originActorItem['id']:_0x1e414d(0xeb)+originActor['id']:null,'tint':'','transfer':transfer,'flags':flags};}static[_0xd41dd7(0xff)]({key:_0x5896c3,value:_0x481d12,mode:mode=CONST[_0xd41dd7(0xf6)][_0xd41dd7(0xe1)],priority:priority=null}){const _0x43a1d6=_0xd41dd7;if(_0x5896c3==null||_0x481d12===undefined)throw new Error(_0x43a1d6(0xfd));return{'key':_0x5896c3,'mode':mode,'value':_0x481d12,'priority':priority};}static[_0xd41dd7(0x121)](_0x3eee74){const _0x452f51=_0xd41dd7;return SharedConsts[_0x452f51(0xf9)]+'.'+_0x3eee74;}static[_0xd41dd7(0x127)](_0xa627a6){const _0xd8f88e=_0xd41dd7;return _0xa627a6[_0xd8f88e(0x130)](new RegExp(SharedConsts[_0xd8f88e(0xf9)]+'\x5c.'),'');}static[_0xd41dd7(0x11b)](_0x3a2ad8){const _0x266173=_0xd41dd7;if(typeof _0x3a2ad8===_0x266173(0xd0))return _0x3a2ad8;const [,_0x27eb25=0x0]=Object['entries'](CONST[_0x266173(0xf6)])[_0x266173(0x115)](([_0x1c04ba])=>_0x1c04ba[_0x266173(0xf0)]()===(''+_0x3a2ad8)[_0x266173(0xd9)]()[_0x266173(0xf0)]())||[];return _0x27eb25;}static[_0xd41dd7(0x11d)]({mode:_0xc97816,rawPriority:rawPriority=null}){const _0x42038b=_0xd41dd7;if(rawPriority!=null&&!isNaN(rawPriority))return rawPriority;return _0xc97816>=CONST[_0x42038b(0xf6)][_0x42038b(0x103)]?UtilActiveEffects[_0x42038b(0x11a)]:UtilActiveEffects['PRIORITY_BONUS'];}}UtilActiveEffects['_AVAIL_EFFECTS_ACTOR_DND5E']=[],UtilActiveEffects[_0xd41dd7(0x11a)]=0x4,UtilActiveEffects['PRIORITY_BONUS']=0x7;function _0x25d3(_0x4ad681,_0x2b8b25){const _0x52035d=_0x5203();return _0x25d3=function(_0x25d36f,_0x47333f){_0x25d36f=_0x25d36f-0xcc;let _0x57a376=_0x52035d[_0x25d36f];return _0x57a376;},_0x25d3(_0x4ad681,_0x2b8b25);}function _0x5203(){const _0x49b755=['getGenericChange','data','_getExpandedEffects_getKeyPartFunctionOutput','push','DOWNGRADE','getExpandedEffects','characterFlags','ascSortLowerProp','.damage','22nIjQrZ','itemActionTypes','init','image','exec','changes','test','DND5E','flat','bind','filter','utils','origin','find','_getExpandedEffects_getAllKeys','null','1432548IMtmFB','2290896zaAKPR','PRIORITY_BASE','getFoundryMode','.Item.','getPriority','_AVAIL_EFFECTS_ACTOR_DND5E','array','flattenObject','getCustomKey','system','pop','_PATHS_EXTRA__AC','_getExpandedEffects_recurseKey','2svUKey','getKeyFromCustomKey','icon','copy','keys','_getExpandedEffects_getKeyVariableFunctionOutput','default','join','280dCHSFI','endsWith','replace','path','length','data.resources.primary.label','undefined','value','disabled','placeholder','number','model','type','flags.dnd5e.','map','entries','data.bonuses.','data.resources.tertiary.label','dataType','trim','data.attributes.ac.armor','2675705PvgoLH','171432MfckXc','data.attributes.ac.base','name','Generic\x20effect\x20args\x20\x22key\x22/\x22value\x22\x20and\x20\x22changes\x22\x20are\x20mutually\x20exclusive!','data.attributes.ac.cover','OVERRIDE','262433wAXyQi','getAvailableEffectsLookup','_getExpandedEffects_recurseKeyPart','isItemEffect','icons/svg/aura.svg','some','token','split','data.resources.secondary.label','Actor.','slice','getGenericEffect','1278151wSIBMS','img','toLowerCase','isActorEffect','4qepKFh','unique','getAvailableEffects','getActiveEffectType','ACTIVE_EFFECT_MODES','forEach','6ELLJmN','MODULE_NAME_FAKE','sort','data.attributes.ac.bonus','1164405OIYHOk','Generic\x20effect\x20change\x20\x22key\x22\x20and\x20\x22value\x22\x20must\x20be\x20defined!','mode'];_0x5203=function(){return _0x49b755;};return _0x5203();}export{UtilActiveEffects};