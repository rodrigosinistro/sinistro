function _0x3936(_0x34593e,_0x4093f7){const _0xc10bac=_0xc10b();return _0x3936=function(_0x39366d,_0x11941f){_0x39366d=_0x39366d-0x76;let _0x2d69f2=_0xc10bac[_0x39366d];return _0x2d69f2;},_0x3936(_0x34593e,_0x4093f7);}const _0x8afd36=_0x3936;(function(_0x36c045,_0x2485c6){const _0x3426db=_0x3936,_0x1b3517=_0x36c045();while(!![]){try{const _0x4beb0f=-parseInt(_0x3426db(0x7f))/0x1+parseInt(_0x3426db(0xcb))/0x2+parseInt(_0x3426db(0x82))/0x3*(parseInt(_0x3426db(0xc4))/0x4)+parseInt(_0x3426db(0xe2))/0x5+parseInt(_0x3426db(0x8f))/0x6*(parseInt(_0x3426db(0x99))/0x7)+parseInt(_0x3426db(0xb7))/0x8+-parseInt(_0x3426db(0x88))/0x9*(parseInt(_0x3426db(0x7b))/0xa);if(_0x4beb0f===_0x2485c6)break;else _0x1b3517['push'](_0x1b3517['shift']());}catch(_0x5628ca){_0x1b3517['push'](_0x1b3517['shift']());}}}(_0xc10b,0xbff65));import{UtilList2}from'./UtilList2.js';import{UtilApplications}from'./UtilApplications.js';import{Util}from'./Util.js';function _0xc10b(){const _0x35ffcf=['Macro','macro','14lPibFL','_list','absorbFnBindListeners','getValues','<h3>Are\x20you\x20sure?</h3><p>Any\x20empty\x20folders\x20will\x20be\x20permanently\x20deleted.</p>','Scene','tables','table','content','item','render','checked','bind','STR_SEE_CONSOLE','add','delete','type','Delete','_$btnReset','_activateListeners_initBtnPrune','[name=\x22cb-select-all\x22]','Failed\x20to\x20delete\x20','map','reset','pInitFilterBox','fa-trash','_activateListeners_doBindSelectAll','_$iptSearch','path','card\x20stack','4108856nCOswc','scene','card\x20stacks','children','their','deleteDocuments','...','Deleting\x20','_listSortNamePathRows','name','Delete\x20Folders','_activateListeners_initBtnReset','[name=btn-toggle-summary]','2017448jDVNLo','_pageFilter','<h3>Are\x20you\x20sure?</h3><p>','length','ascSortLower','_collectionName','values','2997136UpRUbj','uppercaseFirst','ele','actors','_activateListeners_listAbsorbGetData','getFolderPath','\x20data\x20will\x20be\x20permanently\x20deleted.</p>','[name=\x22btn-prune\x22]','sidebar','Deleted\x20','items','_sortNamePathRows','has','initBtnSortHandlers','macros','collection','filter','find','prop','_folderType','Item','.search','Task','7733055iYzlsq','_namePlural','journal','info','filterBox','[name=\x22btn-reset\x22]','_pDoPruneFolders','contents','Actor','_gameProp','get','instance','bindSelectAllCheckbox','_rows','_handleFilterChange','scenes','_documentClass','Cards','38570OKEEwz','cards','_pDoDelete','then','537069fCgkNh','_nameSingle','addToFilters','3iYmTCR','journal\x20entries','notifications','_sidebarTab','input','RollTable','6876nCItJf','data','actor','click','JournalEntry','_collection','Folder','620838WUeGzd','Delete\x20','Delete\x20Complete','toDisplay','journal\x20entry','Please\x20select\x20something\x20to\x20delete!','its','_getSelectedIds'];_0xc10b=function(){return _0x35ffcf;};return _0xc10b();}class BaseCollectionTool extends Application{static[_0x8afd36(0xd6)](_0x492385,_0x8b106a){const _0x296f93=_0x8afd36;if(_0x492385[_0x296f93(0xb5)]==null&&_0x8b106a[_0x296f93(0xb5)]==null)return SortUtil[_0x296f93(0xc8)](_0x492385[_0x296f93(0xc0)],_0x8b106a['name']);if(_0x492385['path']!=null&&_0x8b106a[_0x296f93(0xb5)]==null)return-0x1;if(_0x492385[_0x296f93(0xb5)]==null&&_0x8b106a['path']!=null)return 0x1;return SortUtil[_0x296f93(0xc8)](_0x492385['path'],_0x8b106a['path'])||SortUtil['ascSortLower'](_0x492385[_0x296f93(0xc0)],_0x8b106a[_0x296f93(0xc0)]);}static['_listSortNamePathRows'](_0x3c13cd,_0xd0a229,_0x2a6da2){const _0x1e7d3c=_0x8afd36,_0x3ae509={'name':_0x3c13cd['name'],'path':_0x3c13cd[_0x1e7d3c(0xca)][_0x1e7d3c(0xb5)]},_0x12ccc0={'name':_0xd0a229[_0x1e7d3c(0xc0)],'path':_0xd0a229[_0x1e7d3c(0xca)][_0x1e7d3c(0xb5)]};return BaseCollectionTool[_0x1e7d3c(0xd6)](_0x3ae509,_0x12ccc0);}constructor(_0x13d3c5,_0x66a8dc){const _0x99dd19=_0x8afd36;super(_0x13d3c5),this['_collectionName']=_0x66a8dc,this[_0x99dd19(0x79)]=null,this[_0x99dd19(0x8d)]=null,this[_0x99dd19(0x85)]=null,this['_gameProp']=null,this[_0x99dd19(0xde)]=null,this[_0x99dd19(0x80)]=null,this[_0x99dd19(0xe3)]=null;switch(_0x66a8dc){case _0x99dd19(0xb8):{this[_0x99dd19(0x79)]=Scene,this[_0x99dd19(0x8d)]=CONFIG[_0x99dd19(0x9e)]['collection'][_0x99dd19(0xed)],this[_0x99dd19(0x85)]=_0x99dd19(0x78),this[_0x99dd19(0xeb)]='scenes',this[_0x99dd19(0xde)]='Scene',this[_0x99dd19(0x80)]='scene',this['_namePlural']='scenes';break;}case _0x99dd19(0x8a):{this['_documentClass']=Actor,this['_collection']=CONFIG[_0x99dd19(0xea)][_0x99dd19(0xda)]['instance'],this[_0x99dd19(0x85)]=_0x99dd19(0xce),this[_0x99dd19(0xeb)]=_0x99dd19(0xce),this[_0x99dd19(0xde)]='Actor',this[_0x99dd19(0x80)]=_0x99dd19(0x8a),this[_0x99dd19(0xe3)]=_0x99dd19(0xce);break;}case _0x99dd19(0xa2):{this[_0x99dd19(0x79)]=Item,this[_0x99dd19(0x8d)]=CONFIG[_0x99dd19(0xdf)][_0x99dd19(0xda)][_0x99dd19(0xed)],this['_sidebarTab']=_0x99dd19(0xd5),this['_gameProp']=_0x99dd19(0xd5),this['_folderType']=_0x99dd19(0xdf),this[_0x99dd19(0x80)]=_0x99dd19(0xa2),this['_namePlural']=_0x99dd19(0xd5);break;}case _0x99dd19(0xe4):{this[_0x99dd19(0x79)]=JournalEntry,this[_0x99dd19(0x8d)]=CONFIG[_0x99dd19(0x8c)][_0x99dd19(0xda)][_0x99dd19(0xed)],this[_0x99dd19(0x85)]=_0x99dd19(0xe4),this[_0x99dd19(0xeb)]=_0x99dd19(0xe4),this[_0x99dd19(0xde)]=_0x99dd19(0x8c),this[_0x99dd19(0x80)]=_0x99dd19(0x93),this['_namePlural']=_0x99dd19(0x83);break;}case'rolltable':{this[_0x99dd19(0x79)]=RollTable,this['_collection']=CONFIG[_0x99dd19(0x87)]['collection'][_0x99dd19(0xed)],this[_0x99dd19(0x85)]='tables',this[_0x99dd19(0xeb)]='tables',this[_0x99dd19(0xde)]=_0x99dd19(0x87),this[_0x99dd19(0x80)]=_0x99dd19(0xa0),this[_0x99dd19(0xe3)]=_0x99dd19(0x9f);break;}case _0x99dd19(0x98):{this[_0x99dd19(0x79)]=Macro,this[_0x99dd19(0x8d)]=CONFIG[_0x99dd19(0x97)][_0x99dd19(0xda)][_0x99dd19(0xed)],this['_sidebarTab']=null,this[_0x99dd19(0xeb)]=_0x99dd19(0xd9),this[_0x99dd19(0xde)]=null,this[_0x99dd19(0x80)]='macro',this['_namePlural']=_0x99dd19(0xd9);break;}case _0x99dd19(0x7c):{this['_documentClass']=Cards,this[_0x99dd19(0x8d)]=CONFIG[_0x99dd19(0x7a)][_0x99dd19(0xda)][_0x99dd19(0xed)],this['_sidebarTab']=_0x99dd19(0x7c),this[_0x99dd19(0xeb)]=_0x99dd19(0x7c),this['_folderType']='Cards',this[_0x99dd19(0x80)]=_0x99dd19(0xb6),this[_0x99dd19(0xe3)]=_0x99dd19(0xb9);break;}default:throw new Error('Unknown\x20collection\x20\x22'+_0x66a8dc+'\x22');}}['_mapEntitiesToRows'](){const _0x395525=_0x8afd36;return this[_0x395525(0x8d)][_0x395525(0xe9)][_0x395525(0xaf)]((_0x4a8696,_0x62071a)=>{const _0x5bf348=_0x395525,_0x2bad4f=UtilApplications[_0x5bf348(0xd0)](_0x4a8696,{'isAddTrailingSlash':!![]});return{'path':_0x2bad4f,'name':_0x4a8696[_0x5bf348(0xc0)],'displayName':''+(_0x2bad4f||'')+_0x4a8696['name'],'id':_0x4a8696['id'],'type':MiscUtil[_0x5bf348(0xec)](_0x4a8696,_0x5bf348(0x89),_0x5bf348(0xa9))||'unknown','ix':_0x62071a};})['sort'](BaseCollectionTool['_sortNamePathRows']);}['_handleFilterChange'](){const _0x4da529=_0x8afd36,_0x12de76=this[_0x4da529(0xc5)][_0x4da529(0xe6)][_0x4da529(0x9c)]();this['_list']['filter'](_0x2f649a=>this[_0x4da529(0xc5)][_0x4da529(0x92)](_0x12de76,this[_0x4da529(0x76)][_0x2f649a['ix']]));}[_0x8afd36(0xc2)](_0x1f1ba0){const _0x4cec2e=_0x8afd36;this[_0x4cec2e(0xab)]=_0x1f1ba0[_0x4cec2e(0xdc)](_0x4cec2e(0xe7))[_0x4cec2e(0x8b)](()=>{const _0x55f853=_0x4cec2e;_0x1f1ba0[_0x55f853(0xdc)]('.search')['val']('');if(this[_0x55f853(0x9a)])this[_0x55f853(0x9a)][_0x55f853(0xb0)]();});}[_0x8afd36(0xcf)](_0x40f559){return UtilList2['absorbFnGetData'](_0x40f559);}[_0x8afd36(0xb3)](_0x5e9015){const _0x135e38=_0x8afd36;ListUiUtil[_0x135e38(0xee)](_0x5e9015,this[_0x135e38(0x9a)]);}['_activateListeners_pInitListAndFilters'](_0x37258a){const _0x182828=_0x8afd36;return this[_0x182828(0xb4)]=_0x37258a[_0x182828(0xdc)](_0x182828(0xe0)),this['_list']=new List({'$iptSearch':this[_0x182828(0xb4)],'$wrpList':_0x37258a[_0x182828(0xdc)]('.veapp__list'),'fnSort':BaseCollectionTool[_0x182828(0xbf)]}),SortUtil[_0x182828(0xd8)](_0x37258a['find']('[data-name=\x22wrp-btns-sort\x22]'),this[_0x182828(0x9a)]),this[_0x182828(0xb3)](_0x37258a['find'](_0x182828(0xad))),this[_0x182828(0xc5)][_0x182828(0xb1)]({'$iptSearch':this['_$iptSearch'],'$btnReset':this[_0x182828(0xab)],'$btnOpen':_0x37258a[_0x182828(0xdc)]('[name=btn-filter]'),'$btnToggleSummaryHidden':_0x37258a['find'](_0x182828(0xc3)),'$wrpMiniPills':_0x37258a['find']('.fltr__mini-view'),'namespace':'tool-'+this['_collectionName']})[_0x182828(0x7e)](()=>{const _0x49dbbd=_0x182828;this[_0x49dbbd(0x76)]['forEach'](_0xe1d308=>this[_0x49dbbd(0xc5)][_0x49dbbd(0x81)](_0xe1d308)),this[_0x49dbbd(0x9a)]['doAbsorbItems'](this[_0x49dbbd(0x76)],{'fnGetName':_0x248669=>_0x248669[_0x49dbbd(0xc0)],'fnGetValues':_0x55ae38=>({'id':_0x55ae38['id'],'path':_0x55ae38[_0x49dbbd(0xb5)]}),'fnGetData':this['_activateListeners_listAbsorbGetData']['bind'](this),'fnBindListeners':_0x19e364=>UtilList2[_0x49dbbd(0x9b)](this[_0x49dbbd(0x9a)],_0x19e364)}),this[_0x49dbbd(0x9a)]['init'](),this[_0x49dbbd(0xc5)]['trimState'](),this['_pageFilter']['filterBox'][_0x49dbbd(0xa3)](),this[_0x49dbbd(0xc5)][_0x49dbbd(0xe6)]['on'](FilterBox['EVNT_VALCHANGE'],this[_0x49dbbd(0x77)][_0x49dbbd(0xa5)](this)),this[_0x49dbbd(0x77)]();});}['_getSelectedIds'](){const _0x277ab1=_0x8afd36;return this[_0x277ab1(0x9a)][_0x277ab1(0xd5)][_0x277ab1(0xdb)](_0x2a788a=>$(_0x2a788a[_0x277ab1(0xcd)])['find'](_0x277ab1(0x86))['prop'](_0x277ab1(0xa4)))['map'](_0x109993=>({'name':_0x109993[_0x277ab1(0xc0)],'id':_0x109993[_0x277ab1(0xca)]['id']}));}[_0x8afd36(0xac)](_0x9a4fbf){const _0x5c2d3b=_0x8afd36;_0x9a4fbf[_0x5c2d3b(0xdc)](_0x5c2d3b(0xd2))[_0x5c2d3b(0x8b)](async()=>{const _0x4019fd=_0x5c2d3b,_0x3c8b04=await UtilApplications['pGetConfirmation']({'title':_0x4019fd(0xc1),'content':_0x4019fd(0x9d),'confirmText':_0x4019fd(0xaa),'faIcon':_0x4019fd(0xb2)});if(!_0x3c8b04)return;await this[_0x4019fd(0xe8)]();});}async[_0x8afd36(0x7d)](_0x20e505){const _0x5e82b5=_0x8afd36;if(!this[_0x5e82b5(0x9a)])return;let _0x1f9d97=this[_0x5e82b5(0x96)]();if(!_0x1f9d97[_0x5e82b5(0xc7)])return ui[_0x5e82b5(0x84)]['warn'](_0x5e82b5(0x94));const _0x73c423=this[_0x5e82b5(0xc9)][_0x5e82b5(0xcc)](),_0x2286da=_0x1f9d97[_0x5e82b5(0xc7)]!==0x1?'s':'',_0x26e488=await UtilApplications['pGetConfirmation']({'title':_0x5e82b5(0x90)+_0x73c423+_0x2286da,'content':_0x5e82b5(0xc6)+_0x1f9d97['length']+'\x20'+_0x73c423+_0x2286da+'\x20and\x20'+(_0x2286da?_0x5e82b5(0xbb):_0x5e82b5(0x95))+_0x5e82b5(0xd1),'confirmText':_0x5e82b5(0xaa),'faIcon':_0x5e82b5(0xb2)});if(!_0x26e488)return;this['close']();if(this[_0x5e82b5(0x85)])ui[_0x5e82b5(0xd3)]['activateTab'](this[_0x5e82b5(0x85)]);if(_0x20e505[_0x5e82b5(0xdd)]('checked')){const _0x33f7ae=await this[_0x5e82b5(0xe8)](_0x1f9d97[_0x5e82b5(0xaf)](({id:_0xfca17b})=>_0xfca17b));_0x1f9d97=_0x1f9d97['filter'](({id:_0x1d34cf})=>!_0x33f7ae[_0x5e82b5(0xd7)](_0x1d34cf));}const _0x476d38=new Util[(_0x5e82b5(0xe1))](_0x1f9d97[_0x5e82b5(0xc7)],()=>this[_0x5e82b5(0x79)][_0x5e82b5(0xbc)](_0x1f9d97['map'](({id:_0x1098c0})=>_0x1098c0)));await UtilApplications['pRunTasks']([_0x476d38],{'titleInitial':'Deleting...','titleComplete':_0x5e82b5(0x91),'fnGetRowRunningText':_0x18d44f=>_0x5e82b5(0xbe)+_0x18d44f+'\x20'+(_0x18d44f===0x1?this[_0x5e82b5(0x80)]:this[_0x5e82b5(0xe3)])+_0x5e82b5(0xbd),'fnGetRowSuccessText':_0x4e3f9a=>_0x5e82b5(0xd4)+_0x4e3f9a+'\x20'+(_0x4e3f9a===0x1?this[_0x5e82b5(0x80)]:this['_namePlural'])+'.','fnGetRowErrorText':_0x49cdae=>_0x5e82b5(0xae)+_0x49cdae+'\x20'+(_0x49cdae===0x1?this['_nameSingle']:this[_0x5e82b5(0xe3)])+'!\x20'+VeCt[_0x5e82b5(0xa6)]});if(_0x20e505[_0x5e82b5(0xdd)](_0x5e82b5(0xa4)))await this[_0x5e82b5(0xe8)]();game[this['_gameProp']][_0x5e82b5(0xa3)]();}async[_0x8afd36(0xe8)](_0x5139cc){const _0x4d820d=_0x8afd36,_0x9ae63=()=>CONFIG[_0x4d820d(0x8e)]['collection'][_0x4d820d(0xed)]['contents'][_0x4d820d(0xdb)](_0x5d00be=>_0x5d00be[_0x4d820d(0x89)][_0x4d820d(0xa9)]===this[_0x4d820d(0xde)]),_0x28a297=_0x5139cc?new Set(_0x5139cc):null,_0x20a110=new Set();let _0x18f670=0x0,_0x5eca33=null,_0x23c4a3=_0x9ae63()[_0x4d820d(0xc7)];do{let _0x3df946;_0x28a297?_0x3df946=_0x9ae63()[_0x4d820d(0xdb)](_0x5d3592=>{const _0x2394e4=_0x4d820d;if(!_0x5d3592[_0x2394e4(0xba)]||!_0x5d3592[_0x2394e4(0xba)][_0x2394e4(0xc7)]){if(!_0x5d3592[_0x2394e4(0xa1)][_0x2394e4(0xc7)])return!![];const _0x4a9a0d=_0x5d3592[_0x2394e4(0xa1)]['map'](_0x40368e=>_0x40368e['id'])[_0x2394e4(0xdb)](_0x1e4dd4=>_0x28a297['has'](_0x1e4dd4));if(_0x4a9a0d['length']===_0x5d3592['content'][_0x2394e4(0xc7)])return _0x4a9a0d['forEach'](_0x526e4b=>_0x20a110[_0x2394e4(0xa7)](_0x526e4b)),!![];}return![];}):_0x3df946=_0x9ae63()[_0x4d820d(0xdb)](_0x1ce4b8=>!_0x1ce4b8[_0x4d820d(0xa1)][_0x4d820d(0xc7)]&&(!_0x1ce4b8[_0x4d820d(0xba)]||!_0x1ce4b8[_0x4d820d(0xba)][_0x4d820d(0xc7)]));for(const _0x1c8536 of _0x3df946){await _0x1c8536[_0x4d820d(0xa8)]({'deleteSubfolders':!![],'deleteContents':!![]}),_0x18f670++;}_0x5eca33=_0x23c4a3,_0x23c4a3=_0x9ae63()[_0x4d820d(0xc7)];}while(_0x23c4a3!==_0x5eca33);if(_0x18f670)ui[_0x4d820d(0x84)][_0x4d820d(0xe5)](_0x4d820d(0xd4)+_0x18f670+'\x20folder'+(_0x18f670===0x1?'':'s')+'.');return _0x20a110;}}export{BaseCollectionTool};