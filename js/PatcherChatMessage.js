const _0x31554d=_0x4ca5;(function(_0x40fc0f,_0x5d4379){const _0x1501cc=_0x4ca5,_0x4f13a4=_0x40fc0f();while(!![]){try{const _0x5879f3=parseInt(_0x1501cc(0xa1))/0x1+parseInt(_0x1501cc(0xc0))/0x2+-parseInt(_0x1501cc(0x9d))/0x3*(parseInt(_0x1501cc(0xc2))/0x4)+-parseInt(_0x1501cc(0x95))/0x5*(parseInt(_0x1501cc(0xc1))/0x6)+parseInt(_0x1501cc(0x9c))/0x7+-parseInt(_0x1501cc(0xba))/0x8+parseInt(_0x1501cc(0xa9))/0x9;if(_0x5879f3===_0x5d4379)break;else _0x4f13a4['push'](_0x4f13a4['shift']());}catch(_0x1b83f1){_0x4f13a4['push'](_0x4f13a4['shift']());}}}(_0x13c9,0xb8557));import{Config}from'./Config.js';import{SharedConsts}from'../shared/SharedConsts.js';class Patcher_ChatMessage{static[_0x31554d(0xb0)]({isInit:isInit=![]}={}){const _0x372033=_0x31554d;try{return this[_0x372033(0xa0)]();}catch(_0x52d21e){if(!isInit)throw _0x52d21e;Config['handleFailedInitConfigApplication']('ui',_0x372033(0xb1),_0x52d21e);}}static[_0x31554d(0xa0)](){const _0x66cf70=_0x31554d;if(Patcher_ChatMessage[_0x66cf70(0x99)]==null||Patcher_ChatMessage['_LAST_CONFIG_STATE']!==Config[_0x66cf70(0xbb)]('ui',_0x66cf70(0xb1))){Patcher_ChatMessage['_LAST_CONFIG_STATE']=Config[_0x66cf70(0xbb)]('ui',_0x66cf70(0xb1));if(Patcher_ChatMessage[_0x66cf70(0x99)])this[_0x66cf70(0xb9)]();else this[_0x66cf70(0xb3)]();}}static['_doAddToExistingMessages'](){const _0xc5bddc=_0x31554d,_0x307830=ui[_0xc5bddc(0x9f)][_0xc5bddc(0xc9)]['find'](_0xc5bddc(0xc5));_0x307830[_0xc5bddc(0x98)]((_0x5738b3,_0x18e63d)=>{const _0x49cbf4=_0xc5bddc,_0x28067d=$(_0x18e63d),_0x82a66f=CONFIG[_0x49cbf4(0xa5)]['collection']['instance']['get'](_0x18e63d[_0x49cbf4(0xbe)][_0x49cbf4(0xa8)]);this[_0x49cbf4(0xaa)](_0x82a66f,_0x28067d,!![]);});}static[_0x31554d(0xb3)](){const _0x30078f=_0x31554d,_0x4a1b19=ui['chat'][_0x30078f(0xc9)]['find']('.message');_0x4a1b19[_0x30078f(0x98)]((_0x4fd7ec,_0x15e0b1)=>{const _0x5dcc84=_0x30078f;_0x15e0b1['classList'][_0x5dcc84(0x8d)](_0x5dcc84(0xc6)),_0x15e0b1[_0x5dcc84(0xcd)][_0x5dcc84(0x8d)](_0x5dcc84(0xbc)),$(_0x15e0b1)[_0x5dcc84(0xaf)](_0x5dcc84(0x94)+Patcher_ChatMessage[_0x5dcc84(0xb2)])['off'](_0x5dcc84(0xa6)+Patcher_ChatMessage[_0x5dcc84(0xb2)])['off']('mouseleave.'+Patcher_ChatMessage['_EVENT_NAMESPACE']);});}static[_0x31554d(0xb5)](){const _0x53cfe6=_0x31554d;Hooks['on'](_0x53cfe6(0xcc),(_0x44b2c9,_0x454ca8)=>{const _0x411789=_0x53cfe6;if(!Config['get']('ui',_0x411789(0xb1)))return;this[_0x411789(0xaa)](_0x44b2c9,_0x454ca8);}),Hooks['on'](_0x53cfe6(0xae),(..._0x2a756a)=>{const _0x38d683=_0x53cfe6;if(!Config[_0x38d683(0xbb)]('ui','isCompactChat'))return;this[_0x38d683(0xb4)](..._0x2a756a);});}static[_0x31554d(0xaa)](_0x3209e8,_0x1f9d76,_0xab1dec){const _0x32903f=_0x31554d;if(!_0xab1dec){const _0x21949f=this[_0x32903f(0xca)](_0x3209e8);if(_0x21949f&&_0x21949f[_0x32903f(0x9a)])return this[_0x32903f(0x8f)](_0x3209e8,_0x1f9d76,_0x21949f);}if(!this[_0x32903f(0xb8)](_0x3209e8)){Patcher_ChatMessage[_0x32903f(0xad)]=this[_0x32903f(0x91)](_0x3209e8,_0x1f9d76);return;}Patcher_ChatMessage['_LAST_MESSAGE_META']['$ele']['addClass'](_0x32903f(0xbc));const _0x137e5a=this[_0x32903f(0x91)](_0x3209e8,_0x1f9d76);_0x137e5a['$ele'][_0x32903f(0x9b)]('chatmsg__trim-top'),this['_doBindTrimmedTopEventHandlers'](_0x137e5a['$ele']),Patcher_ChatMessage[_0x32903f(0xad)]=_0x137e5a;}static[_0x31554d(0x91)](_0x3193b2,_0x57c340){const _0x37c7c1=_0x31554d,_0x11fa72=_0x57c340['find'](_0x37c7c1(0x92));return{'$ele':_0x57c340,'$header':_0x11fa72,'chatMessage':_0x3193b2};}static['_$getExistingRender'](_0xb7b191){const _0x13a746=_0x31554d;return ui[_0x13a746(0x9f)]['element'][_0x13a746(0xa2)]('.message[data-message-id=\x22'+_0xb7b191['id']+'\x22]');}static[_0x31554d(0x8f)](_0x209652,_0x2a4aac,_0x97f52f){const _0x4c55e1=_0x31554d;if(_0x97f52f[_0x4c55e1(0xab)](_0x4c55e1(0xbc)))_0x2a4aac['addClass']('chatmsg__trim-bottom');_0x97f52f[_0x4c55e1(0xab)]('chatmsg__trim-top')&&(_0x2a4aac[_0x4c55e1(0x9b)]('chatmsg__trim-top'),this[_0x4c55e1(0x96)](_0x2a4aac));}static[_0x31554d(0xb8)](_0x572319){const _0x1f5407=_0x31554d;if(!Patcher_ChatMessage[_0x1f5407(0xad)])return![];const {chatMessage:_0x5c9e26}=Patcher_ChatMessage[_0x1f5407(0xad)];if(!_0x5c9e26?.[_0x1f5407(0x97)]||!_0x572319?.[_0x1f5407(0x97)])return![];if(_0x5c9e26[_0x1f5407(0x97)][_0x1f5407(0xac)]<_0x572319[_0x1f5407(0x97)]['timestamp']-Patcher_ChatMessage[_0x1f5407(0xb7)])return![];if(_0x5c9e26[_0x1f5407(0x93)]?.['id']!==_0x572319['user']?.['id'])return![];if(_0x5c9e26[_0x1f5407(0x93)]?.[_0x1f5407(0xc3)]!==_0x572319['user']?.['color'])return![];if(_0x5c9e26[_0x1f5407(0xbf)]?.['id']!==_0x572319['author']?.['id'])return![];if(_0x5c9e26[_0x1f5407(0xb6)]!==_0x572319[_0x1f5407(0xb6)])return![];if(!CollectionUtil[_0x1f5407(0x9e)](_0x5c9e26[_0x1f5407(0x97)]?.['whisper'],_0x572319[_0x1f5407(0x97)]?.[_0x1f5407(0xa7)]))return![];if(_0x5c9e26[_0x1f5407(0x97)]?.[_0x1f5407(0x90)]!==_0x572319['data']?.[_0x1f5407(0x90)])return![];return!![];}static[_0x31554d(0xb4)](_0x241aae){const _0x2e8e6b=_0x31554d,_0x492210=ui['chat'][_0x2e8e6b(0xc9)][_0x2e8e6b(0xa2)]('.message[data-message-id=\x22'+_0x241aae['id']+'\x22]'),_0x57e82f=_0x492210[_0x2e8e6b(0x8e)](),_0x6d2f40=_0x492210[_0x2e8e6b(0xc7)]();_0x6d2f40[_0x2e8e6b(0x9a)]&&(!_0x492210[_0x2e8e6b(0xab)]('chatmsg__trim-top')&&_0x492210[_0x2e8e6b(0xab)](_0x2e8e6b(0xbc))&&_0x6d2f40[_0x2e8e6b(0xc4)]('chatmsg__trim-top'));_0x57e82f[_0x2e8e6b(0x9a)]&&(_0x492210['hasClass'](_0x2e8e6b(0xc6))&&!_0x492210[_0x2e8e6b(0xab)]('chatmsg__trim-bottom')&&_0x57e82f[_0x2e8e6b(0xc4)](_0x2e8e6b(0xbc)));if(Patcher_ChatMessage['_LAST_MESSAGE_META']){const {chatMessage:_0x4f8ce5}=Patcher_ChatMessage[_0x2e8e6b(0xad)];if(_0x4f8ce5===_0x241aae)Patcher_ChatMessage[_0x2e8e6b(0xad)]=null;}}static['_doBindTrimmedTopEventHandlers'](_0x4f7a4b){const _0x3b1d6c=_0x31554d;_0x4f7a4b['on'](_0x3b1d6c(0x94)+Patcher_ChatMessage['_EVENT_NAMESPACE'],_0xb81099=>{const _0x4d4bf5=_0x3b1d6c;if(!_0xb81099['shiftKey'])return;_0x4f7a4b['addClass'](_0x4d4bf5(0xa3));})['on'](_0x3b1d6c(0xa6)+Patcher_ChatMessage[_0x3b1d6c(0xb2)],_0x5b4f84=>{const _0x264f25=_0x3b1d6c;if(!_0x5b4f84[_0x264f25(0xbd)])return;_0x4f7a4b[_0x264f25(0x9b)](_0x264f25(0xa3));})['on'](_0x3b1d6c(0xcb)+Patcher_ChatMessage[_0x3b1d6c(0xb2)],()=>{const _0x368f1a=_0x3b1d6c;_0x4f7a4b[_0x368f1a(0xc4)]('chatmsg__trim-top--inspecting');});}}Patcher_ChatMessage[_0x31554d(0x99)]=null,Patcher_ChatMessage[_0x31554d(0xb7)]=0x7530,Patcher_ChatMessage[_0x31554d(0xad)]=null,Patcher_ChatMessage['_EVENT_NAMESPACE']=SharedConsts[_0x31554d(0xc8)]+_0x31554d(0xa4);function _0x13c9(){const _0x1944af=['shiftKey','dataset','author','2120512EEumnr','6168stqzqp','12kOObmL','color','removeClass','.message','chatmsg__trim-top','next','MODULE_NAME','element','_$getExistingRender','mouseleave.','renderChatMessage','classList','remove','prev','_doHandleExistingMessage','blind','_getMessageMeta','header.message-header','user','mousemove.','5275UrNdtq','_doBindTrimmedTopEventHandlers','data','each','_LAST_CONFIG_STATE','length','addClass','9033332qsaVcq','1487991TqBKSt','deepEquals','chat','_handleConfigUpdate_','961904vrMHHh','find','chatmsg__trim-top--inspecting','-chat','ChatMessage','mouseover.','whisper','messageId','10956528RVEYcp','_handleRenderChatMessage','hasClass','timestamp','_LAST_MESSAGE_META','deleteChatMessage','off','handleConfigUpdate','isCompactChat','_EVENT_NAMESPACE','_doRemoveFromExistingMessages','_handleDeleteChatMessage','init','alias','_SPEAKER_TIMEOUT_MSEC','_isMetaMatch','_doAddToExistingMessages','9619728VqwbrP','get','chatmsg__trim-bottom'];_0x13c9=function(){return _0x1944af;};return _0x13c9();}function _0x4ca5(_0x3c1c37,_0x3fc209){const _0x13c9c2=_0x13c9();return _0x4ca5=function(_0x4ca5bd,_0x118ab2){_0x4ca5bd=_0x4ca5bd-0x8d;let _0x2f1415=_0x13c9c2[_0x4ca5bd];return _0x2f1415;},_0x4ca5(_0x3c1c37,_0x3fc209);}export{Patcher_ChatMessage};