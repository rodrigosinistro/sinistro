const _0xd24ff8=_0x3f07;(function(_0x392833,_0x1e9bc9){const _0x51ead6=_0x3f07,_0x57c5cc=_0x392833();while(!![]){try{const _0x5b3a6c=-parseInt(_0x51ead6(0x1ca))/0x1*(-parseInt(_0x51ead6(0x1e1))/0x2)+parseInt(_0x51ead6(0x1c2))/0x3+-parseInt(_0x51ead6(0x1ac))/0x4*(-parseInt(_0x51ead6(0x1db))/0x5)+parseInt(_0x51ead6(0x1fa))/0x6*(parseInt(_0x51ead6(0x1ae))/0x7)+-parseInt(_0x51ead6(0x1c7))/0x8+-parseInt(_0x51ead6(0x1ea))/0x9*(parseInt(_0x51ead6(0x1d9))/0xa)+-parseInt(_0x51ead6(0x1e0))/0xb;if(_0x5b3a6c===_0x1e9bc9)break;else _0x57c5cc['push'](_0x57c5cc['shift']());}catch(_0x487cd3){_0x57c5cc['push'](_0x57c5cc['shift']());}}}(_0x4d46,0x97dbf));function _0x4d46(){const _0x3ac422=['6jCCAKO','getSrdCompendiumEntity','_pGetEffectsSideLoaded','utils','<div>\x0a\x09\x09\x09\x09','special','pMutActorUpdateOptionalFeature','/media/icon/skills.svg','MODULE_NAME','FS:R','get','_pGetDescriptionValue','permission','pGetDereferencedOptionalFeatureFeatureItem','importOptionalFeature','230260GeTKCI','name','2764295kWsypi','optionalfeature','getNameWithSourcePart','_pGetSideLoadedMatch','_getCompendiumAliases','18513946luhDmm','332698NhyOit','setImplSideData','pGetSideLoadedMatch','\x0a\x09\x09\x09\x09','pGetOptionalFeatureSideData','init','entries','_pGetOptionalFeatureItem_other','type','351ApgyKP','_pGetPreloadSideData','getExpandedEffects','URL_TO_HASH_BUILDER','Metamagic:\x20','FS:B','filterValues','permissions','source','copy','actor','FS:F','_pGetDataSideLoaded','effects','propDroppable','MODULE_NAME_FAKE','84juiqRM','pHasOptionalFeatureSideLoadedEffects','pInitOptionalFeatureLoadeds','_getData_getConsume','push','proxy','pGetOptionalFeatureItemEffects','mutActorUpdate','_SIDE_DATA','isAddPermission','feat','getCleanEntityName','Invocation:\x20','PG_OPT_FEATURES','Fighting\x20Style:\x20','_getOptionalFeatureFlags','_pGetEffectsRawSideLoaded_','defaultPermission','_foundryData','isActorItem','getSourceWithPagePart','8wrizwu','_IMG_FALLBACK','302267EXNjed','<p><i>','some','_pIsInSrd','data','pGetWithDescriptionPlugins','hover','featureType','activation','</i></p>','_pGetFlagsSideLoaded','length','foundryOptionalfeature','_FEATURE_TYPES','pGetOptionalFeatureItem','_SIDE_LOAD_OPTS','_pGetOptionalFeatureItem_fromSrd','setFirstSection','pGetInitOptionalFeatureFeatureLoadeds','set','2178603DWKZdu','pCacheAndGet','getPrerequisiteHtml','_pGetSaveImagePath','_getRequirementsString','1851456sEjgwM','prerequisite','getCleanedFeature_tmpOptionalfeatureList'];_0x4d46=function(){return _0x3ac422;};return _0x4d46();}function _0x3f07(_0x3a1108,_0x547676){const _0x4d4603=_0x4d46();return _0x3f07=function(_0x3f0734,_0x3b48df){_0x3f0734=_0x3f0734-0x1a8;let _0x736c9b=_0x4d4603[_0x3f0734];return _0x736c9b;},_0x3f07(_0x3a1108,_0x547676);}import{UtilApplications}from'./UtilApplications.js';import{SharedConsts}from'../shared/SharedConsts.js';import{Config}from'./Config.js';import{Vetools}from'./Vetools.js';import{UtilCompendium}from'./UtilCompendium.js';import{UtilActiveEffects}from'./UtilActiveEffects.js';import{DataConverterFeature}from'./DataConverterFeature.js';import{PageFilterClassesFoundry}from'./UtilCharactermancerClass.js';import{UtilDataConverter}from'./UtilDataConverter.js';import{DataConverter}from'./DataConverter.js';import{Charactermancer_Feature_Util}from'./UtilCharactermancerFeature.js';class DataConverterOptionalfeature extends DataConverterFeature{static ['_SIDE_LOAD_OPTS']={'propBrew':_0xd24ff8(0x1ba),'fnLoadJson':async()=>this[_0xd24ff8(0x1eb)](),'propJson':_0xd24ff8(0x1dc)};static [_0xd24ff8(0x1ad)]='modules/'+SharedConsts[_0xd24ff8(0x1d2)]+_0xd24ff8(0x1d1);static[_0xd24ff8(0x1e6)](){const _0x29011a=_0xd24ff8;PageFilterClassesFoundry[_0x29011a(0x1e2)]('optionalfeature',this);}static async[_0xd24ff8(0x1d7)](_0x1b6e9e){const _0x430a66=_0xd24ff8;if(_0x1b6e9e[_0x430a66(0x1e7)])return MiscUtil[_0x430a66(0x1f3)](_0x1b6e9e);const _0x38259f=UrlUtil[_0x430a66(0x1ed)][UrlUtil[_0x430a66(0x207)]](_0x1b6e9e);return Renderer[_0x430a66(0x1b4)][_0x430a66(0x1c3)](UrlUtil[_0x430a66(0x207)],_0x1b6e9e['source'],_0x38259f,{'isCopy':!![]});}static async[_0xd24ff8(0x1c0)](_0x6be9ed,{actor:actor=null}={}){const _0x515c62=_0xd24ff8,_0x5a14b3=DataUtil[_0x515c62(0x1ff)]['getUid'](_0x515c62(0x1dc),_0x6be9ed,{'isMaintainCase':!![]}),_0x457884={'optionalfeature':_0x5a14b3};return await PageFilterClassesFoundry[_0x515c62(0x1fc)]({'optionalfeature':_0x457884,'raw':_0x6be9ed,'actor':actor}),_0x457884;}static async[_0xd24ff8(0x1bc)](_0x29f67e,_0x3a46a3){const _0x2c9ce5=_0xd24ff8;_0x3a46a3=_0x3a46a3||{};if(_0x3a46a3[_0x2c9ce5(0x1f4)])_0x3a46a3[_0x2c9ce5(0x1aa)]=!![];const _0x15685b=Charactermancer_Feature_Util[_0x2c9ce5(0x1c9)](_0x29f67e);let _0x596d82;return await this[_0x2c9ce5(0x1b1)](_0x15685b,_0x3a46a3)?_0x596d82=this[_0x2c9ce5(0x1be)](_0x15685b,_0x3a46a3):_0x596d82=this[_0x2c9ce5(0x1e8)](_0x15685b,_0x3a46a3),_0x596d82;}static async[_0xd24ff8(0x1b1)](_0x4d1196){const _0x3c62f2=_0xd24ff8,_0x2d3ae8=await UtilCompendium[_0x3c62f2(0x1cb)]('optionalfeature',_0x4d1196,{'fnGetAliases':this[_0x3c62f2(0x1df)]});return!!_0x2d3ae8;}static async[_0xd24ff8(0x1be)](_0x5f0d73,_0x4bf004){const _0x38e05e=_0xd24ff8,_0xe2d511=await UtilCompendium['getSrdCompendiumEntity']('optionalfeature',_0x5f0d73,{'fnGetAliases':this[_0x38e05e(0x1df)]}),_0x28b2bb=await this['_pGetDescriptionValue'](_0x5f0d73),_0x55e26b=this['_getData_getConsume']({'ent':_0x5f0d73,'actor':_0x4bf004[_0x38e05e(0x1f4)]}),_0xdf0739=_0x55e26b?.[_0x38e05e(0x1e9)]&&!_0xe2d511[_0x38e05e(0x1b2)]?.['activation']?.[_0x38e05e(0x1e9)]?_0x38e05e(0x1cf):_0xe2d511['data']?.[_0x38e05e(0x1b6)]?.[_0x38e05e(0x1e9)],_0x1d5613=await this[_0x38e05e(0x1f6)](_0x5f0d73),_0x2c5cb9=await this[_0x38e05e(0x1b8)](_0x5f0d73),_0x3180ba=[...MiscUtil[_0x38e05e(0x1f3)](_0xe2d511[_0x38e05e(0x1f7)]||[]),..._0x4bf004[_0x38e05e(0x1aa)]?[]:await this[_0x38e05e(0x1cc)]({'ent':_0x5f0d73,'img':_0xe2d511['img']})||[]];DataConverter['mutEffectsDisabledTransfer'](_0x3180ba,_0x38e05e(0x1d8));const _0x3af552={'name':UtilApplications[_0x38e05e(0x205)](UtilDataConverter[_0x38e05e(0x1dd)](_0x5f0d73,{'isActorItem':_0x4bf004[_0x38e05e(0x1aa)]})),'type':_0xe2d511[_0x38e05e(0x1e9)],'data':{..._0xe2d511['data'],'activation':{'type':_0xdf0739},'source':UtilDataConverter[_0x38e05e(0x1ab)](_0x5f0d73),'description':{'value':_0x28b2bb,'chat':'','unidentified':''},'requirements':this['_getRequirementsString'](_0x5f0d73),'consume':_0x55e26b,..._0x1d5613},'permission':{'default':0x0},'img':await this[_0x38e05e(0x1c5)](_0x5f0d73,{'propCompendium':'optionalfeature'}),'flags':{...this[_0x38e05e(0x209)](_0x5f0d73,_0x4bf004),..._0x2c5cb9},'effects':_0x3180ba};if(_0x4bf004['defaultPermission']!=null)_0x3af552['permission']={'default':_0x4bf004[_0x38e05e(0x1a8)]};else{if(_0x4bf004[_0x38e05e(0x203)])_0x3af552[_0x38e05e(0x1d6)]={'default':Config[_0x38e05e(0x1d4)]('importOptionalFeature',_0x38e05e(0x1f1))};}return _0x3af552;}static async[_0xd24ff8(0x1e8)](_0x3d75d6,_0x147dc0){const _0x243fc9=_0xd24ff8,_0x2bfe0b=await this[_0x243fc9(0x1d5)](_0x3d75d6),_0xf83d82=this[_0x243fc9(0x1fd)]({'ent':_0x3d75d6,'actor':_0x147dc0[_0x243fc9(0x1f4)]}),_0x692920=await this['_pGetSaveImagePath'](_0x3d75d6,{'propCompendium':'optionalfeature'}),_0x475268=await this[_0x243fc9(0x1f6)](_0x3d75d6),_0x140d8f=await this[_0x243fc9(0x1b8)](_0x3d75d6),_0x26b279=_0x147dc0['isActorItem']?[]:await this['_pGetEffectsSideLoaded']({'ent':_0x3d75d6,'img':_0x692920});DataConverter['mutEffectsDisabledTransfer'](_0x26b279,_0x243fc9(0x1d8));const _0x22048a={'name':UtilApplications['getCleanEntityName'](UtilDataConverter[_0x243fc9(0x1dd)](_0x3d75d6,{'isActorItem':_0x147dc0['isActorItem']})),'data':{'source':UtilDataConverter[_0x243fc9(0x1ab)](_0x3d75d6),'description':{'value':_0x2bfe0b,'chat':'','unidentified':''},'activation':{'type':_0xf83d82?.[_0x243fc9(0x1e9)]?_0x243fc9(0x1cf):'','cost':null,'condition':''},'duration':{'value':0x0,'units':''},'target':{'value':0x0,'units':'','type':''},'range':{'value':0x0,'long':0x0,'units':null},'uses':{'value':0x0,'max':0x0,'per':''},'ability':'','actionType':'','attackBonus':null,'chatFlavor':'','critical':{'threshold':null,'damage':''},'damage':{'parts':[],'versatile':''},'formula':'','save':{'ability':'','dc':null},'requirements':this[_0x243fc9(0x1c6)](_0x3d75d6),'consume':_0xf83d82,'recharge':{'value':0x0,'charged':!![]},..._0x475268},'permission':{'default':0x0},'type':_0x243fc9(0x204),'img':_0x692920,'flags':{...this['_getOptionalFeatureFlags'](_0x3d75d6,_0x147dc0),..._0x140d8f},'effects':_0x26b279};if(_0x147dc0[_0x243fc9(0x1a8)]!=null)_0x22048a[_0x243fc9(0x1d6)]={'default':_0x147dc0[_0x243fc9(0x1a8)]};else{if(_0x147dc0[_0x243fc9(0x203)])_0x22048a[_0x243fc9(0x1d6)]={'default':Config[_0x243fc9(0x1d4)](_0x243fc9(0x1d8),_0x243fc9(0x1f1))};}return _0x22048a;}static[_0xd24ff8(0x1d5)](_0x35609){const _0x16069b=_0xd24ff8;if(!Config[_0x16069b(0x1d4)](_0x16069b(0x1d8),'isImportDescription'))return'';return UtilDataConverter[_0x16069b(0x1b3)](()=>{const _0x3408c0=_0x16069b,_0x4e5067=Renderer[_0x3408c0(0x1cd)][_0x3408c0(0x1c4)](_0x35609[_0x3408c0(0x1c8)]);return _0x3408c0(0x1ce)+(_0x4e5067?_0x3408c0(0x1af)+_0x4e5067+_0x3408c0(0x1b7):'')+_0x3408c0(0x1e4)+Renderer[_0x3408c0(0x1d4)]()[_0x3408c0(0x1bf)](!![])['render']({'entries':_0x35609[_0x3408c0(0x1e7)]},0x2)+'\x0a\x09\x09\x09</div>';});}static[_0xd24ff8(0x1c6)](_0x54d5c4){const _0x2c49da=_0xd24ff8;return _0x54d5c4[_0x2c49da(0x1a9)]?.['requirements']||Renderer[_0x2c49da(0x1cd)][_0x2c49da(0x1c4)](_0x54d5c4[_0x2c49da(0x1c8)],{'isTextOnly':!![],'isSkipPrefix':!![]});}static[_0xd24ff8(0x209)](_0x2f41be,_0x314804){const _0xe525a5=_0xd24ff8;_0x314804=_0x314804||{};const _0xfeffce={[SharedConsts[_0xe525a5(0x1f9)]]:{'page':UrlUtil[_0xe525a5(0x207)],'source':_0x2f41be[_0xe525a5(0x1f2)],'hash':UrlUtil[_0xe525a5(0x1ed)][UrlUtil[_0xe525a5(0x207)]](_0x2f41be)}};return _0x314804['isAddDataFlags']&&(_0xfeffce[SharedConsts[_0xe525a5(0x1f9)]][_0xe525a5(0x1f8)]='optionalfeature',_0xfeffce[SharedConsts[_0xe525a5(0x1f9)]][_0xe525a5(0x1f0)]=_0x314804[_0xe525a5(0x1f0)]),_0xfeffce;}static async[_0xd24ff8(0x1d0)](_0x2d7948,_0x57ea7c,_0x3b0540,_0x3040bc){const _0x5c3030=_0xd24ff8,_0x49dbdf=await this[_0x5c3030(0x1e3)](_0x3b0540);this[_0x5c3030(0x201)](_0x2d7948,_0x57ea7c,_0x3b0540,{'sideData':_0x49dbdf});}static async[_0xd24ff8(0x1eb)](){const _0x5940de=_0xd24ff8;if(!this[_0x5940de(0x202)])this[_0x5940de(0x202)]=await Vetools[_0x5940de(0x1e5)]();return this[_0x5940de(0x202)];}static async[_0xd24ff8(0x1e3)](_0x20472a){const _0x3671d0=_0xd24ff8;return this[_0x3671d0(0x1de)](_0x20472a,this[_0x3671d0(0x1bd)]);}static async[_0xd24ff8(0x1fb)](_0x2fa248,_0x4455ed){const _0x12d6d2=_0xd24ff8;return(await this[_0x12d6d2(0x20a)](_0x4455ed,this[_0x12d6d2(0x1bd)]))?.[_0x12d6d2(0x1b9)]>0x0;}static async[_0xd24ff8(0x200)](_0x577ef7,_0x1adb3e,_0x3cf860,{additionalData:_0x1c0284,img:_0x10dfc6}={}){const _0x38eaba=_0xd24ff8,_0x41c479=await this[_0x38eaba(0x20a)](_0x1adb3e,this[_0x38eaba(0x1bd)]);return UtilActiveEffects[_0x38eaba(0x1ec)](_0x41c479||[],{'actor':_0x577ef7,'sheetItem':_0x3cf860,'parentName':_0x1adb3e['name'],'additionalData':_0x1c0284,'img':_0x10dfc6});}static[_0xd24ff8(0x1df)](_0xbb8e10){const _0x1752e4=_0xd24ff8;if(!_0xbb8e10[_0x1752e4(0x1da)]||!_0xbb8e10['srd'])return[];const _0x9b6d0d=[];for(const [_0x252f33,_0xac0237]of DataConverterOptionalfeature[_0x1752e4(0x1bb)][_0x1752e4(0x1e7)]()){if(_0xbb8e10[_0x1752e4(0x1b5)][_0x1752e4(0x1b0)](_0x3fe889=>_0x252f33['has'](_0x3fe889)))_0x9b6d0d[_0x1752e4(0x1fe)](_0xac0237(_0xbb8e10));}return _0x9b6d0d;}}DataConverterOptionalfeature[_0xd24ff8(0x1bb)]=new Map(),DataConverterOptionalfeature[_0xd24ff8(0x1bb)][_0xd24ff8(0x1c1)](new Set(['EI']),_0x384101=>_0xd24ff8(0x206)+_0x384101[_0xd24ff8(0x1da)]),DataConverterOptionalfeature['_FEATURE_TYPES']['set'](new Set(['MM']),_0x3294b2=>_0xd24ff8(0x1ee)+_0x3294b2[_0xd24ff8(0x1da)]),DataConverterOptionalfeature['_FEATURE_TYPES']['set'](new Set([_0xd24ff8(0x1f5),_0xd24ff8(0x1ef),'FS:P',_0xd24ff8(0x1d3)]),_0x2b82ad=>_0xd24ff8(0x208)+_0x2b82ad[_0xd24ff8(0x1da)]);export{DataConverterOptionalfeature};