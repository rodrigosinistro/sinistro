const _0x65da23=_0x1303;(function(_0x949390,_0x42d087){const _0x2197e2=_0x1303,_0x2c0ab4=_0x949390();while(!![]){try{const _0x4873b9=parseInt(_0x2197e2(0x167))/0x1*(parseInt(_0x2197e2(0x175))/0x2)+parseInt(_0x2197e2(0x169))/0x3*(-parseInt(_0x2197e2(0x19c))/0x4)+-parseInt(_0x2197e2(0x1a3))/0x5*(parseInt(_0x2197e2(0x190))/0x6)+-parseInt(_0x2197e2(0x15b))/0x7*(parseInt(_0x2197e2(0x184))/0x8)+-parseInt(_0x2197e2(0x189))/0x9*(parseInt(_0x2197e2(0x171))/0xa)+parseInt(_0x2197e2(0x162))/0xb*(parseInt(_0x2197e2(0x178))/0xc)+-parseInt(_0x2197e2(0x16c))/0xd*(-parseInt(_0x2197e2(0x1aa))/0xe);if(_0x4873b9===_0x42d087)break;else _0x2c0ab4['push'](_0x2c0ab4['shift']());}catch(_0x2814af){_0x2c0ab4['push'](_0x2c0ab4['shift']());}}}(_0x3a0f,0xa8f48));import{SharedConsts}from'../shared/SharedConsts.js';import{Consts}from'./Consts.js';import{Config}from'./Config.js';function _0x1303(_0x240760,_0x38c800){const _0x3a0fef=_0x3a0f();return _0x1303=function(_0x130334,_0x6f463e){_0x130334=_0x130334-0x150;let _0x596432=_0x3a0fef[_0x130334];return _0x596432;},_0x1303(_0x240760,_0x38c800);}import{Patcher_Token}from'./PatcherToken.js';function _0x3a0f(){const _0x5dec06=['actor','sceneId','min','Versions','isBetterRolltablesActive','name','\x22\x20was\x20not\x20valid!','Scene','7BUPOWm','render','startsWith','user','isGM','prepareData','_handleConfigUpdate','589897fHElcI','deleteDialog','findIndex','innerHeight','MODULE_NAME','73LvMZcv','entityId','3384042naJtlK','_doInitActorData','applyActiveEffect','13EcXrkh','HK_CONFIG_UPDATE','src','active','pGetUserString','40qlMdIF','_FOLDER_MAX_DEPTH','getActorDirectoryEntryContext','contents','8258rGpNiW','_doPatchJournalContextMenuOptions','setRivetTargetActor','36UqPAyP','attr','handleHookApplyActiveEffect','_CONST_ORIGINAL','FOLDER_MAX_DEPTH__ORIGINAL','collection','isOwner','Actor','data','handleConfigUpdate','_handleConfigUpdate_folderMaxDepth','init','2659160EnRlZw','isVersionNinePlus','preInit','forceClose','<i\x20class=\x22fas\x20fa-fw\x20fa-link\x22></i>','915759IHFNLz','scenes','isAddDeleteToSceneNavOptions','STR_SEE_CONSOLE','bind','get','_handleConfigUpdate_folderMaxDepth_','588834bZxuuf','trim','<i\x20class=\x22fas\x20fa-fw\x20fa-trash\x22></i>','_doPatchNavContextMenuOptions','getSceneNavigationContext','isUseExtendedActiveEffectsParser','element','push','values','getJournalDirectoryEntryContext','documentId','forEach','4xXDoUb','setFlag','isEnableIncreasedFolderDepth','splice','Set\x20URL','canvasReady','CONST','5FkJpSL','getBoundingClientRect','getCoreVersion','Failed\x20to\x20apply\x20custom\x20active\x20effect\x20parsing\x20to\x20actor\x20\x22','apps','error','URL/iframe\x20\x22','30734116UbObKF','FOLDER_MAX_DEPTH','SCENES.Configure','PERMISSION.Configure','isEnableUrlEmbeds','nav','close','notifications'];_0x3a0f=function(){return _0x5dec06;};return _0x3a0f();}import{Patcher_TextEditor}from'./PatcherTextEditor.js';import{Patcher_ChatMessage}from'./PatcherChatMessage.js';import{Patcher_SettingsConfig}from'./PatcherSettingsConfig.js';import{Patcher_CanvasAnimation}from'./PatcherCanvasAnimation.js';import{Patcher_Jquery}from'./PatcherJquery.js';import{Patcher_GameKeyboard}from'./PatcherGameKeyboard.js';import{Patcher_ActiveEffectConfig}from'./PatcherActiveEffectConfig.js';import{Patcher_Actor}from'./PatcherActor.js';import{Patcher_Drawing}from'./PatcherDrawing.js';import{JournalSheet_Plutonium}from'./PatcherJournalSheet.js';import{LGT,Util}from'./Util.js';import{Patcher_Item}from'./PatcherItem.js';import{Patcher_ModuleManagement}from'./PatcherModuleManagement.js';import{Patcher_Application}from'./PatcherApplication.js';import{UtilHooks}from'./UtilHooks.js';import{Patcher_RollData}from'./PatcherRollData.js';import{Patcher_ChatLog}from'./PatcherChatLog.js';import{UtilCompat}from'./UtilCompat.js';import{Patcher_ActorSheet}from'./PatcherActorSheet.js';import{Patcher_Notifications}from'./PatcherNotifications.js';import{Patcher_KeybindingsConfig}from'./PatcherKeybindingsConfig.js';import{Patcher_SceneControls}from'./PatcherSceneControls.js';class Patcher{static[_0x65da23(0x186)](){const _0x25954f=_0x65da23;Patcher_ChatLog[_0x25954f(0x186)](),Patcher_GameKeyboard[_0x25954f(0x186)](),Patcher_SceneControls['preInit']();}static[_0x65da23(0x183)](){const _0x1b0e23=_0x65da23;Patcher_Notifications[_0x1b0e23(0x183)](),Hooks['on'](_0x1b0e23(0x16b),Patcher_Actor[_0x1b0e23(0x17a)][_0x1b0e23(0x18d)](Patcher_Actor)),this[_0x1b0e23(0x193)](),this['_doPatchActorContextMenuOptions'](),this[_0x1b0e23(0x176)](),Patcher_Application['init'](),Patcher_TextEditor['init'](),Patcher_ChatMessage[_0x1b0e23(0x183)](),Patcher_SettingsConfig[_0x1b0e23(0x183)](),Patcher_CanvasAnimation[_0x1b0e23(0x183)](),Patcher_Jquery[_0x1b0e23(0x183)](),Patcher_GameKeyboard['init'](),Patcher_ActiveEffectConfig[_0x1b0e23(0x183)](),Patcher_Actor[_0x1b0e23(0x183)](),Patcher_ActorSheet[_0x1b0e23(0x183)](),Patcher_Item[_0x1b0e23(0x183)](),Patcher_RollData['init'](),Patcher_ModuleManagement[_0x1b0e23(0x183)](),Patcher_KeybindingsConfig['init'](),UtilHooks['on'](UtilHooks[_0x1b0e23(0x16d)],_0x13466f=>this[_0x1b0e23(0x161)](_0x13466f)),this['_handleConfigUpdate']({'isInit':!![]}),this['_doInitActorData'](),Hooks['on'](_0x1b0e23(0x1a1),()=>{const _0x320aca=_0x1b0e23;Patcher_Drawing[_0x320aca(0x181)]();});}static[_0x65da23(0x161)]({isInit:isInit=![],..._0x15c2b4}={}){const _0x2f7981=_0x65da23;this[_0x2f7981(0x182)]({'isInit':isInit}),Patcher_Token[_0x2f7981(0x181)]({'isInit':isInit,..._0x15c2b4}),Patcher_Drawing[_0x2f7981(0x181)]({'isInit':isInit}),Patcher_ChatMessage['handleConfigUpdate']({'isInit':isInit}),JournalSheet_Plutonium['handleConfigUpdate']({'isInit':isInit});if(ui[_0x2f7981(0x150)]?.[_0x2f7981(0x196)])ui[_0x2f7981(0x150)][_0x2f7981(0x15c)]();}static[_0x65da23(0x16a)](){const _0x3f5d51=_0x65da23;if(!Config[_0x3f5d51(0x18e)](_0x3f5d51(0x153),_0x3f5d51(0x195)))return;(CONFIG[_0x3f5d51(0x17f)][_0x3f5d51(0x17d)]['instance'][_0x3f5d51(0x174)]||[])[_0x3f5d51(0x19b)](_0x591c90=>{const _0x4db2fb=_0x3f5d51;try{_0x591c90[_0x4db2fb(0x160)]();}catch(_0x1fbb1b){const _0x4b0a03=_0x4db2fb(0x1a6)+_0x591c90['id']+'\x22!';ui[_0x4db2fb(0x152)][_0x4db2fb(0x1a8)](_0x4b0a03+'\x20'+VeCt[_0x4db2fb(0x18c)]),console['error'](...LGT,_0x4b0a03),console['error'](_0x1fbb1b);}});}static[_0x65da23(0x193)](){const _0x38c139=_0x65da23;Hooks['on'](_0x38c139(0x194),(_0x5123e3,_0x5c9f72)=>{const _0x1f47b5=_0x38c139;if(!Config[_0x1f47b5(0x18e)]('ui',_0x1f47b5(0x18b)))return;const _0x1bb0f4=_0x5c9f72[_0x1f47b5(0x164)](_0x1857d9=>_0x1857d9['name']===_0x1f47b5(0x1ac)),_0x42d234={'name':'SIDEBAR.Delete','icon':_0x1f47b5(0x192),'condition':_0x5643cb=>{const _0x42995c=_0x1f47b5,_0x32bf94=game[_0x42995c(0x18a)][_0x42995c(0x18e)](_0x5643cb['data'](_0x42995c(0x154)));return game[_0x42995c(0x15e)][_0x42995c(0x15f)]&&!_0x32bf94[_0x42995c(0x180)][_0x42995c(0x16f)];},'callback':_0x4fba53=>{const _0x9acdf9=_0x1f47b5,_0x47f006=CONFIG[_0x9acdf9(0x15a)][_0x9acdf9(0x17d)]['instance'][_0x9acdf9(0x18e)](_0x4fba53[_0x9acdf9(0x180)](_0x9acdf9(0x154)));if(!_0x47f006)return;const {top:_0x4943f5,left:_0x2c1674}=_0x4fba53[0x0][_0x9acdf9(0x1a4)]();return _0x47f006[_0x9acdf9(0x163)]({'top':Math[_0x9acdf9(0x155)](_0x4943f5+0x46,window[_0x9acdf9(0x165)]-0x15e),'left':Math[_0x9acdf9(0x155)](_0x2c1674,window['innerWidth']-0x2d0)});}};if(~_0x1bb0f4)_0x5c9f72[_0x1f47b5(0x19f)](_0x1bb0f4+0x1,0x0,_0x42d234);else _0x5c9f72[_0x1f47b5(0x197)](_0x42d234);return _0x5c9f72;});}static['_doPatchActorContextMenuOptions'](){const _0x4d3991=_0x65da23;Hooks['on'](_0x4d3991(0x173),(_0x24c234,_0x150532)=>{return _0x150532['push']({'name':'Set\x20as\x20Rivet\x20Target','icon':'<i\x20class=\x22fas\x20fa-fw\x20fa-hammer\x22></i>','condition':_0x1a0348=>{const _0x4f388d=_0x1303,_0x34d2c5=ActorDirectory[_0x4f388d(0x17d)][_0x4f388d(0x18e)](_0x1a0348['data'](Util[_0x4f388d(0x156)][_0x4f388d(0x1a5)]()[_0x4f388d(0x185)]?_0x4f388d(0x19a):_0x4f388d(0x168)));return _0x34d2c5[_0x4f388d(0x17e)];},'callback':_0x3feef2=>{const _0x35831b=_0x1303,_0x1c3335=ActorDirectory[_0x35831b(0x17d)][_0x35831b(0x18e)](_0x3feef2['data'](Util[_0x35831b(0x156)][_0x35831b(0x1a5)]()[_0x35831b(0x185)]?'documentId':_0x35831b(0x168))),_0x3d4320=game['actors'][_0x35831b(0x18e)](_0x1c3335['id']);Config[_0x35831b(0x177)](_0x3d4320);}}),_0x150532;});}static[_0x65da23(0x176)](){const _0x463ad4=_0x65da23;Hooks['on'](_0x463ad4(0x199),(_0xa1ac86,_0x3fc4fc)=>{const _0x4cab7c=_0x463ad4,_0x2e1529=_0x3fc4fc[_0x4cab7c(0x164)](_0x54d234=>_0x54d234[_0x4cab7c(0x158)]===_0x4cab7c(0x1ad));if(!~_0x2e1529)return _0x3fc4fc;return _0x3fc4fc['splice'](_0x2e1529+0x1,0x0,{'name':_0x4cab7c(0x1a0),'icon':_0x4cab7c(0x188),'condition':_0x56599c=>{const _0x3362cf=_0x4cab7c;if(!Config[_0x3362cf(0x18e)]('journalEntries',_0x3362cf(0x1ae)))return![];const _0x56725f=JournalDirectory[_0x3362cf(0x17d)]['get'](_0x56599c[_0x3362cf(0x180)](Util[_0x3362cf(0x156)][_0x3362cf(0x1a5)]()[_0x3362cf(0x185)]?_0x3362cf(0x19a):'entityId'));return _0x56725f[_0x3362cf(0x17e)];},'callback':async _0x5c3ec6=>{const _0x326eb4=_0x4cab7c,_0x4ce1d9=JournalDirectory['collection']['get'](_0x5c3ec6[_0x326eb4(0x180)](Util['Versions'][_0x326eb4(0x1a5)]()[_0x326eb4(0x185)]?_0x326eb4(0x19a):'entityId')),_0x3c6812=await _0x4ce1d9['getFlag'](SharedConsts[_0x326eb4(0x166)],Consts['FLAG_IFRAME_URL']);let _0x19f91b=await InputUiUtil[_0x326eb4(0x170)]({'title':'Enter\x20iframe\x20or\x20URL','default':_0x3c6812||''});if(_0x19f91b==null)return;Object[_0x326eb4(0x198)](_0x4ce1d9[_0x326eb4(0x1a7)])[_0x326eb4(0x19b)](_0x45c14a=>{const _0x56da6d=_0x326eb4;_0x45c14a[_0x56da6d(0x187)]?_0x45c14a[_0x56da6d(0x187)]():_0x45c14a[_0x56da6d(0x151)]();});if(!_0x19f91b)await _0x4ce1d9['setFlag'](SharedConsts['MODULE_NAME'],Consts['FLAG_IFRAME_URL'],'');else{_0x19f91b=_0x19f91b[_0x326eb4(0x191)]();if(_0x19f91b[_0x326eb4(0x15d)]('<iframe'))_0x19f91b=$(_0x19f91b)[_0x326eb4(0x179)](_0x326eb4(0x16e));!_0x19f91b&&(ui[_0x326eb4(0x152)]['warn'](_0x326eb4(0x1a9)+_0x19f91b+_0x326eb4(0x159)),await _0x4ce1d9[_0x326eb4(0x19d)](SharedConsts['MODULE_NAME'],Consts['FLAG_IFRAME_URL'],'')),await _0x4ce1d9[_0x326eb4(0x19d)](SharedConsts['MODULE_NAME'],Consts['FLAG_IFRAME_URL'],_0x19f91b);}}}),_0x3fc4fc;});}static['_handleConfigUpdate_folderMaxDepth']({isInit:isInit=![]}={}){const _0x185aa6=_0x65da23;try{return this[_0x185aa6(0x18f)]();}catch(_0x4a5fdc){if(!isInit)throw _0x4a5fdc;Config['handleFailedInitConfigApplication']('ui',_0x185aa6(0x19e),_0x4a5fdc);}}static[_0x65da23(0x18f)](){const _0x361a53=_0x65da23;if(Patcher[_0x361a53(0x17b)]==null)Patcher[_0x361a53(0x17b)]=window[_0x361a53(0x1a2)];if(Config[_0x361a53(0x18e)]('ui',_0x361a53(0x19e))&&!UtilCompat[_0x361a53(0x157)]()){if(CONST['FOLDER_MAX_DEPTH']>=Patcher['_FOLDER_MAX_DEPTH'])return;window[_0x361a53(0x1a2)]=MiscUtil['copy'](Patcher['_CONST_ORIGINAL']),CONST[_0x361a53(0x17c)]=CONST['FOLDER_MAX_DEPTH'],CONST[_0x361a53(0x1ab)]=Patcher[_0x361a53(0x172)];}else window['CONST']=Patcher['_CONST_ORIGINAL'];}}Patcher[_0x65da23(0x17b)]=null,Patcher[_0x65da23(0x172)]=0x9;export{Patcher};