function _0xaeda(_0x320516,_0x489e92){const _0x56ad91=_0x56ad();return _0xaeda=function(_0xaedaba,_0x3eea7d){_0xaedaba=_0xaedaba-0xc2;let _0x31051b=_0x56ad91[_0xaedaba];return _0x31051b;},_0xaeda(_0x320516,_0x489e92);}const _0x1c086b=_0xaeda;function _0x56ad(){const _0x534067=['linksFilesDownloaded','_EXTS_IMG','APP_TITLE','download_url','toLowerCase','_state','1014993YUlZRR','_getDefaultState','Importer\x20Image\x20Preloader','466445zWXPZm','14492CwjZsd','webp','name','<i\x20class=\x22fa\x20fa-play\x22></i>\x20Fetch','render','activateListeners','<i\x20class=\x22fa\x20fa-play\x22></i>\x20Download','url','png','all','<button\x20class=\x22btn\x20btn-5et\x20btn-xs\x22></button>','30HbdEfZ','You\x20must\x20enter\x20a\x20GitHub\x20API\x20URL\x20first!','forEach','copy','ghToken','_render_mid','isRunningLinks','replace','[data-name=\x22wrp-mid\x22]','25401TxmEkU','notifications','split','1021062MFziCO','jpg','_render_top','map','trim','$getIptStr','_pFetchLinks_pFetchDir','bmp','_getImageDownloadUrl','isRunningDownloads','<i\x20class=\x22fa\x20fa-pause\x22></i>\x20Pause','message','click','disabled','_comp','autoResizeApplication','linksFiles','has','find','_addHookBase','constructor','MODULE_LOCATION','push','$iptToken','json','pSaveImageToServerAndGetUrl','error','/template/ImportSpecialImagePreloader.hbs','linksDirs','html','token\x20','You\x20must\x20enter\x20a\x20GitHub\x20Personal\x20access\x20token\x20first!','_pFetchLinks','<div\x20class=\x22mr-1\x22></div>','last','filter','pop','prop','text','522452zZWzfc','_pDownloadLinks','length','421253Kgzjle','https://5etools-mirror-1.github.io/','dir','16XqzsMX','ghRepoUrl','type'];_0x56ad=function(){return _0x534067;};return _0x56ad();}(function(_0x570f55,_0x52d2ea){const _0x4e3fa3=_0xaeda,_0xb2ce4a=_0x570f55();while(!![]){try{const _0x506e7c=-parseInt(_0x4e3fa3(0xe8))/0x1+-parseInt(_0x4e3fa3(0xd4))/0x2*(-parseInt(_0x4e3fa3(0xdf))/0x3)+parseInt(_0x4e3fa3(0x112))/0x4+parseInt(_0x4e3fa3(0xd3))/0x5+-parseInt(_0x4e3fa3(0xeb))/0x6+-parseInt(_0x4e3fa3(0xc4))/0x7*(-parseInt(_0x4e3fa3(0xc7))/0x8)+-parseInt(_0x4e3fa3(0xd0))/0x9;if(_0x506e7c===_0x52d2ea)break;else _0xb2ce4a['push'](_0xb2ce4a['shift']());}catch(_0x4d8514){_0xb2ce4a['push'](_0xb2ce4a['shift']());}}}(_0x56ad,0x1a74d));import{SharedConsts}from'../shared/SharedConsts.js';import{UtilApplications}from'./UtilApplications.js';import{Vetools}from'./Vetools.js';class ImportSpecialImagePreloader extends Application{static [_0x1c086b(0xcc)]=_0x1c086b(0xd2);constructor(){const _0x44e53e=_0x1c086b;super({'title':ImportSpecialImagePreloader[_0x44e53e(0xcc)],'template':SharedConsts[_0x44e53e(0x100)]+_0x44e53e(0x106),'width':0x280,'height':0x168,'resizable':!![]}),this[_0x44e53e(0xf9)]=null;}[_0x1c086b(0xd9)](_0x2ce0cb){const _0x53a5b1=_0x1c086b;super[_0x53a5b1(0xd9)](_0x2ce0cb);const _0x210e90=_0x2ce0cb[_0x53a5b1(0xfd)]('[data-name=\x22wrp-top\x22]'),_0xcb3318=_0x2ce0cb[_0x53a5b1(0xfd)](_0x53a5b1(0xe7));this[_0x53a5b1(0xf9)]=new _ImportSpecialImagePreloaderComp(),this['_comp'][_0x53a5b1(0xd8)]({'$stgTop':_0x210e90,'$stgMid':_0xcb3318}),UtilApplications[_0x53a5b1(0xfa)](this);}}class _ImportSpecialImagePreloaderComp extends BaseComponent{static [_0x1c086b(0xcb)]=new Set([_0x1c086b(0xec),'jpeg',_0x1c086b(0xdc),_0x1c086b(0xd5),_0x1c086b(0xf2)]);static ['_Render']=class{constructor(){const _0x3f8876=_0x1c086b;this[_0x3f8876(0x102)]=null,this[_0x3f8876(0x107)]=[];}};['render']({$stgTop:_0x423953,$stgMid:_0x1ad086}){const _0x15ce27=_0x1c086b,_0x1cd432=new this[(_0x15ce27(0xff))]['_Render']();this[_0x15ce27(0xed)]({'render':_0x1cd432,'$stgTop':_0x423953}),this[_0x15ce27(0xe4)]({'render':_0x1cd432,'$stgMid':_0x1ad086});}['_render_top']({render:_0x330c5e,$stgTop:_0x5f4221}){const _0x45aea5=_0x1c086b;_0x330c5e[_0x45aea5(0x102)]=ComponentUiUtil['$getIptStr'](this,_0x45aea5(0xe3)),$$(_0x5f4221)`
			<div class="ve-flex-col">
				<div class="mb-2">To make use of this tool, you must first create a <b>GitHub Personal access token</b>. This increases the number of requests you can make to GitHub, where the images are stored, from 60/hour to 5,000/hour.</div>

				<ol>
					<li>(Create a <a href="https://github.com/" target="_blank">GitHub account</a>)</li>
					<li>Go to your <a href="https://github.com/settings/tokens" target="_blank">GitHub Developer settings</a> &rarr; <code>Personal access tokens</code></li>
					<li>
						<code>Generate a new token</code>. Enter e.g. &quot;Image Downloader&quot; as the <code>Note</code>, and set the <code>Expiration</code> to &quot;<span title="Or less, if you prefer. Since we're not enabling any scopes, the token we generate is &quot;harmless.&quot;" class="help--hover">Never</span>&quot;. Scroll to the bottom of the page (<b>do not</b> enable any scopes) and <code>Generate Token</code>.
					</li>
					<li>Copy the token (<code>ghp_...</code>) and enter it below. <b>Keep a note of your token</b> so you can re-use it in future!</li>
				</ol>

				<div class="ve-flex-col">
					<label class="ve-flex-v-center">
						<div class="mr-2 no-shrink">GitHub <code>Personal access token</code></div>
						${_0x330c5e[_0x45aea5(0x102)]}
					</label>
				</div>
			</div>
		`;}['_render_mid']({render:_0x182f22,$stgMid:_0x462625}){const _0x90159b=_0x1c086b,_0x3889b2=ComponentUiUtil[_0x90159b(0xf0)](this,_0x90159b(0xc8)),_0x17630a=[$('<div\x20class=\x22mr-2\x22></div>'),$('<div\x20class=\x22mr-2\x22></div>')],_0x233db7=()=>_0x17630a[_0x90159b(0xe1)](_0xe8c8c3=>_0xe8c8c3[_0x90159b(0x111)](this[_0x90159b(0xcf)][_0x90159b(0xfb)][_0x90159b(0xc3)]));this[_0x90159b(0xfe)]('linksFiles',_0x233db7),_0x233db7();const _0x3582f6=$(_0x90159b(0x10c)),_0xa19c44=()=>_0x3582f6[_0x90159b(0x111)](this[_0x90159b(0xcf)]['linksFilesDownloaded'][_0x90159b(0xc3)]);this[_0x90159b(0xfe)](_0x90159b(0xca),_0xa19c44),_0xa19c44();const _0x21666c=$(_0x90159b(0xde))['click'](()=>{const _0x1e50c0=_0x90159b;if(!this[_0x1e50c0(0xcf)][_0x1e50c0(0xe5)]){this[_0x1e50c0(0xcf)][_0x1e50c0(0xe5)]=!this['_state'][_0x1e50c0(0xe5)];if(!this[_0x1e50c0(0xcf)][_0x1e50c0(0xe3)])return ui['notifications'][_0x1e50c0(0x105)](_0x1e50c0(0x10a));if(!this[_0x1e50c0(0xcf)][_0x1e50c0(0xc8)])return ui[_0x1e50c0(0xe9)][_0x1e50c0(0x105)](_0x1e50c0(0xe0));return this[_0x1e50c0(0x10b)](_0x182f22);}this[_0x1e50c0(0xcf)][_0x1e50c0(0xe5)]=!this[_0x1e50c0(0xcf)][_0x1e50c0(0xe5)];}),_0x4e9b24=()=>{const _0x268b7d=_0x90159b;_0x21666c['html'](this['_state'][_0x268b7d(0xe5)]?_0x268b7d(0xf5):_0x268b7d(0xd7)),_0x3889b2[_0x268b7d(0x110)](_0x268b7d(0xf8),this['_state'][_0x268b7d(0xe5)]),_0x182f22['$iptToken'][_0x268b7d(0x110)](_0x268b7d(0xf8),this['_state'][_0x268b7d(0xe5)]);};this['_addHookBase']('isRunningLinks',_0x4e9b24),_0x4e9b24();const _0x496781=$(_0x90159b(0xde))[_0x90159b(0xf7)](()=>{const _0xcdacdc=_0x90159b;if(!this[_0xcdacdc(0xcf)][_0xcdacdc(0xf4)])return this['_state'][_0xcdacdc(0xf4)]=!this[_0xcdacdc(0xcf)][_0xcdacdc(0xf4)],this[_0xcdacdc(0xc2)]();this[_0xcdacdc(0xcf)]['isRunningDownloads']=!this[_0xcdacdc(0xcf)][_0xcdacdc(0xf4)];}),_0x268b02=()=>_0x496781[_0x90159b(0x108)](this[_0x90159b(0xcf)]['isRunningDownloads']?_0x90159b(0xf5):_0x90159b(0xda));this['_addHookBase'](_0x90159b(0xf4),_0x268b02),_0x268b02(),$$(_0x462625)`<div class="ve-flex-col">
			<div class="ve-flex-col mb-2">
				<label class="ve-flex-v-center">
					<div class="mr-2 no-shrink">GitHub API URL</code></div>
					${_0x3889b2}
				</label>
			</div>

			<div class="ve-flex-v-center mb-2">
				<div class="mr-2 bold">Links:</div>
				${_0x17630a[0x0]}
				${_0x21666c}
			</div>

			<div class="ve-flex-v-center">
				<div class="mr-2 bold">Downloads:</div>
				${_0x3582f6}
				<div class="mr-1">/</div>
				${_0x17630a[0x1]}
				${_0x496781}
			</div>
		</div>`;}async['_pFetchLinks'](_0x273637){const _0x60ebe6=_0x1c086b;if(!this[_0x60ebe6(0xcf)][_0x60ebe6(0xfb)][_0x60ebe6(0xc3)]&&!_0x273637['linksDirs']['length']){const {urlsDirs:_0x3d9b88,urlsFiles:_0x1edb28}=await this[_0x60ebe6(0xf1)](this[_0x60ebe6(0xcf)][_0x60ebe6(0xc8)]);_0x273637[_0x60ebe6(0x107)]['push'](..._0x3d9b88),this['_state']['linksFiles']=[..._0x1edb28];}const _0x2aa1c0=[...new Array(0x8)][_0x60ebe6(0xee)](async()=>{const _0x486dff=_0x60ebe6;while(_0x273637[_0x486dff(0x107)]['length']){const _0x13f93b=_0x273637[_0x486dff(0x107)][_0x486dff(0x10f)](),{urlsDirs:_0x6b895e,urlsFiles:_0x13dd52}=await this['_pFetchLinks_pFetchDir'](_0x13f93b);_0x273637['linksDirs'][_0x486dff(0x101)](..._0x6b895e),this[_0x486dff(0xcf)][_0x486dff(0xfb)]=[...this[_0x486dff(0xcf)][_0x486dff(0xfb)],..._0x13dd52];if(!this['_state'][_0x486dff(0xe5)])break;}});await Promise['all'](_0x2aa1c0);if(this[_0x60ebe6(0xcf)][_0x60ebe6(0xe5)])this['_state'][_0x60ebe6(0xe5)]=![];}async[_0x1c086b(0xf1)](_0x98343c){const _0xfae09=_0x1c086b,_0x2d9607=await fetch(_0x98343c,{'headers':{'Authorization':_0xfae09(0x109)+this[_0xfae09(0xcf)][_0xfae09(0xe3)]}}),_0x33b7e5=await _0x2d9607[_0xfae09(0x103)]();if(_0x33b7e5['message'])return ui['notifications'][_0xfae09(0x105)](_0x33b7e5[_0xfae09(0xf6)]),console[_0xfae09(0x105)](_0x33b7e5[_0xfae09(0xf6)]),{'urlsDirs':[],'urlsFiles':[]};const [_0x53cb0a,_0x4e6b6a]=_0x33b7e5[_0xfae09(0x10e)](_0x3aec0b=>_0x3aec0b[_0xfae09(0xc9)]===_0xfae09(0xc6)||this['constructor']['_EXTS_IMG'][_0xfae09(0xfc)]((_0x3aec0b[_0xfae09(0xd6)]||'')[_0xfae09(0xea)]('.')[_0xfae09(0x10d)]()[_0xfae09(0xef)]()[_0xfae09(0xce)]()))['map'](_0x29f09c=>_0x29f09c[_0xfae09(0xc9)]==='dir'?{'type':_0x29f09c[_0xfae09(0xc9)],'url':_0x29f09c[_0xfae09(0xdb)]}:{'type':_0x29f09c['type'],'url':this[_0xfae09(0xff)][_0xfae09(0xf3)](_0x29f09c[_0xfae09(0xcd)])})[_0xfae09(0x10e)](_0x305785=>_0x305785[_0xfae09(0xc9)]&&_0x305785['url'])['segregate'](_0x20c691=>_0x20c691[_0xfae09(0xc9)]===_0xfae09(0xc6));return{'urlsDirs':_0x53cb0a['map'](({url:_0x598a4f})=>_0x598a4f),'urlsFiles':_0x4e6b6a[_0xfae09(0xee)](({url:_0x4d8583})=>_0x4d8583)};}static['_getImageDownloadUrl'](_0x49b3af){const _0x21533f=_0x1c086b;return _0x49b3af[_0x21533f(0xe6)](/^https:\/\/raw\.githubusercontent\.com\/5etools-mirror-1\/5etools-mirror-1\.github\.io\/master\//,_0x21533f(0xc5));}async[_0x1c086b(0xc2)](){const _0x12ae8e=_0x1c086b,_0x514c1e=new Set(this['_state']['linksFilesDownloaded']),_0x6af34f=MiscUtil[_0x12ae8e(0xe2)](this['_state']['linksFiles']),_0x1d5cda=[...new Array(0x8)]['map'](async()=>{const _0x1729c1=_0x12ae8e;while(_0x6af34f['length']){const _0x29c99d=_0x6af34f['pop']();if(_0x514c1e[_0x1729c1(0xfc)](_0x29c99d))continue;await Vetools[_0x1729c1(0x104)]({'originalUrl':_0x29c99d,'force':!![]}),_0x514c1e['add'](_0x29c99d),this[_0x1729c1(0xcf)][_0x1729c1(0xca)][_0x1729c1(0x101)](_0x29c99d),this['_triggerCollectionUpdate'](_0x1729c1(0xca));if(!this[_0x1729c1(0xcf)][_0x1729c1(0xf4)])break;}});await Promise[_0x12ae8e(0xdd)](_0x1d5cda);if(this[_0x12ae8e(0xcf)][_0x12ae8e(0xf4)])this[_0x12ae8e(0xcf)][_0x12ae8e(0xf4)]=![];}[_0x1c086b(0xd1)](){return{'ghToken':null,'ghRepoUrl':'https://api.github.com/repos/5etools-mirror-1/5etools-mirror-1/contents/img?ref=master','linksFiles':[],'linksFilesDownloaded':[],'isRunningLinks':![],'isRunningDownloads':![]};}}export{ImportSpecialImagePreloader};