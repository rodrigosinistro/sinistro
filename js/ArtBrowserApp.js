function _0x2523(_0x3b31fe,_0x39ad41){const _0x838a8f=_0x838a();return _0x2523=function(_0x252363,_0xdbdcf2){_0x252363=_0x252363-0xf0;let _0x38856b=_0x838a8f[_0x252363];return _0x38856b;},_0x2523(_0x3b31fe,_0x39ad41);}const _0x1b3a1b=_0x2523;function _0x838a(){const _0x6bdc67=['info','board','_pLoadImageViaBackend','replace','_BLOCKED_HOSTS','artBrowser','progress','currentTarget','Note','imageSaveMode','_INSTANCE','MODULE_NAME','tiles','_pDownloadPack','_preInit_getInnerToolMeta','2612jBQZEM','backendEndpoint','preInit','.artr__search','_onClickLayer','preventDefault','close','artBrowserDownloadPack','ve-art__btn-scene','_pGetDownloadModes','876284NNWBXC','318PBhBzd','_activateListeners_pHandleDownloadAssets','appendTo','notes','P_GET_BACKEND_VERSION','getPosCanvasSpace','deepEquals','dataset','isGM','warn','534937mngGNX','_handleCustomDrop','open','pInit','<i\x20class=\x22fas\x20fa-fw\x20fa-times\x22></i>','.window-content','_pPingImage','body','<div>\x0a\x09\x09\x09\x09\x09<p>The\x20image\x20you\x20dropped\x20could\x20not\x20be\x20loaded,\x20likely\x20due\x20to\x20CORS\x20blocking.\x20CORS\x20blocking\x20is\x20a\x20browser\x20security\x20feature\x20which\x20prevents\x20potentially\x20harmful\x20content\x20from\x20being\x20loaded\x20from\x20other\x20websites.</p>\x0a\x09\x09\x09\x09\x09<p>Unfortunately,\x20this\x20security\x20feature\x20also\x20blocks\x20images.\x20In\x20order\x20to\x20work\x20around\x20this,\x20you\x20can\x20install\x20the\x20','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x22\x20title=\x22Open\x20','buttonDisplay','plutonium__art__hide-tile-button','STR_SEE_CONSOLE','notifications','split','json','_pDoLoadAndPlaceImage','drop','artDirectoryPath','C_ART_IMAGE_MODE_NOTE','<div\x20class=\x22artr__item__menu_item\x22\x20title=\x22Download\x20Image\x22><span\x20class=\x22fas\x20fa-fw\x20fa-download\x22></span></div>','stringify','then','<span\x20class=\x22fas\x20fa-fw\x20fa-cubes\x22></span>','â€”falling\x20back\x20on\x20alternate\x20loader\x20(backend\x20mod).','last','user','Plutonium\x20','addClass','Foundry\x20Assets','some','round','max','noCanvas','Failed\x20to\x20load\x20image!\x20','_preInit_registerKeybinds','scenePadding','_handleConfigUpdate_isRefreshControls','host','_handleInstanceConfigUpdate','Art\x20Browser','33yvCfRh','keybindings','.artr__item__lnk-fullsize','scene','94638lBfUGm','_$btnCycleImportMode','__bound__handleInstanceConfigUpdate','_preInit_addTileButton','bind','HK_CONFIG_UPDATE','init','isSwitchToCreatedScene','find','name','<span\x20class=\x22fas\x20fa-fw\x20fa-user\x22></span>','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22\x20title=\x22Cancel\x20running\x20downloads\x22><span\x20class=\x22fas\x20fa-fw\x20fa-stop\x22></span></button>','get','\x20backend\x20mod.\x20See\x20the\x20&quot;How\x20to\x20Modify\x20the\x20Backend&quot;\x20section\x20on\x20the\x20<a\x20href=\x22https://wiki.tercept.net/en/Plutonium/Plutonium_Installation\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22>wiki</a>\x20for\x20more\x20information.</p>\x0a\x09\x09\x09\x09\x09<p><b>Note\x20that\x20this\x20is\x20not\x20possible\x20on\x20managed\x20Foundry\x20hosting\x20services,\x20such\x20as\x20The\x20Forge.</b></p>\x0a\x09\x09\x09\x09</div>','MODULE_TITLE_FAKE','controls','\x20-\x20Scenes','uri','/template/ArtBrowserApp.hbs','pct','2632690lNLlTF','_BASE_TITLE','isSceneAddToNavigation','register','_doCancelPackDownload','title','push','7eiBoSX','isInit','isSceneGridMetric','_handleConfigUpdate','_ID_HIDE_TILE_BUTTON','naturalHeight','Drag-Drop\x20Images\x20as\x20Tokens','_isDownloadingPack','_ART_SCENE_CONTROLS_NAME','Open\x20Art\x20Browser','\x20-\x20Tiles','bringToFront','application/json','_pCopyImageToLocalViaBackend','getMaxWindowHeight','artBrowserCopyToLocal','getSceneControlButtons','BackgroundLayer','plutonium__art__hide-notes-button','_p$getBtnsItemThumbnail','getElementById','C_ART_IMAGE_MODE_TILE','setApplicationTitle','ve-Art','post','unshift','ArtBrowserApp__open','getMaxWindowWidth','Drag-Drop\x20Images\x20as\x20Notes','importImagesAs','type','Unhandled\x20drop\x20mode\x20\x22','fas\x20fa-fw\x20fa-palette','stopPropagation','error','Close','scale','socket','icons/svg/book.svg','Config\x20window\x22><span\x20class=\x22fas\x20fa-fw\x20fa-cogs\x22></span></button>','_preInit_addNotesButton','Failed\x20to\x20load\x20image!','off','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22><span\x20class=\x22fas\x20fa-fw\x20fa-spinner\x22></span></button>','getData','75LuVWrD','_pOpen','<span\x20class=\x22fas\x20fa-fw\x20fa-bookmark\x22></span>','_preInit_addMainButton','isSceneTokenVision','Download\x20complete!\x20Images\x20will\x20be\x20available\x20in\x20your\x20\x22User\x20Data\x22\x20directory.','html','pLoadImage','isSceneFogExploration','_pDoLoadAndPlaceImage_pDoLoadViaBackend','click','p-0','C_ART_IMAGE_SAVE_MODE__ALWAYS','getDropJson','C_ART_IMAGE_SAVE_MODE__NEVER','MODULE_LOCATION','plutonium__art__hide-token-button','doDownloadSingleImage_','tokenSize','artBrowserCancelDownloadPack','text','4703672hcbDON','Drag-Drop\x20Images\x20as\x20Tiles','getSafe','tools','_preInit_addSubmenuButton','getMetricNumberDistance','create','plutoniumDownloadPackImage','core','C_ART_IMAGE_MODE_TOKEN','884394qaBFvy','render','C_ART_IMAGE_MODE_SCENE','MODULE_TITLE','_handleInstanceConfigUpdate_cycleImportModeButton','_parent','Hi!\x20You\x20shouldn\x27t\x20be\x20able\x20to\x20click\x20this,\x20something\x20has\x20gone\x20wrong.','set','Drag-Drop\x20Images\x20as\x20Scenes','artb__window-outer'];_0x838a=function(){return _0x6bdc67;};return _0x838a();}(function(_0x5d2049,_0x20276d){const _0x313dc7=_0x2523,_0x4a041b=_0x5d2049();while(!![]){try{const _0x1b2fb8=parseInt(_0x313dc7(0x14b))/0x1+parseInt(_0x313dc7(0x136))/0x2*(parseInt(_0x313dc7(0x141))/0x3)+parseInt(_0x313dc7(0x140))/0x4+-parseInt(_0x313dc7(0xfe))/0x5*(parseInt(_0x313dc7(0x178))/0x6)+-parseInt(_0x313dc7(0x193))/0x7*(-parseInt(_0x313dc7(0x113))/0x8)+-parseInt(_0x313dc7(0x11d))/0x9+-parseInt(_0x313dc7(0x18c))/0xa*(parseInt(_0x313dc7(0x174))/0xb);if(_0x1b2fb8===_0x20276d)break;else _0x4a041b['push'](_0x4a041b['shift']());}catch(_0x1fee32){_0x4a041b['push'](_0x4a041b['shift']());}}}(_0x838a,0x56d97));import{SharedConsts}from'../shared/SharedConsts.js';import{Util,LGT}from'./Util.js';import{Config}from'./Config.js';import{UtilCanvas}from'./UtilCanvas.js';import{ArtBrowser}from'../art-js/ArtBrowser.js';import{UtilApplications}from'./UtilApplications.js';import{ConfigConsts}from'./ConfigConsts.js';import{UtilEvents}from'./UtilEvents.js';import{UtilHooks}from'./UtilHooks.js';import{UtilImage}from'./UtilImage.js';import{UtilGameSettings}from'./UtilGameSettings.js';class ArtBrowserFvtt extends ArtBrowser{constructor(_0x4d9856,{app:_0x1e12e7}){const _0x44da20=_0x2523;super(_0x4d9856),this[_0x44da20(0x122)]=_0x1e12e7;}async[_0x1b3a1b(0x13f)](){const _0x2f1014=_0x1b3a1b,_0x44a523=[this['_textDownloadMode'],this['_jsonDownloadMode']];return await Config[_0x2f1014(0x145)]&&_0x44a523[_0x2f1014(0x1ac)]({'name':_0x2f1014(0x168),'isMultipleFilesOnly':!![],'pDownloadAsMultipleFiles':(_0x1f0acc,_0x41058a,_0x35d18a)=>this['_parent'][_0x2f1014(0x142)](_0x1f0acc,_0x41058a,_0x35d18a)}),_0x44a523;}async[_0x1b3a1b(0x1a6)](_0x18f0d4){const _0x494b47=_0x1b3a1b,_0x298349=await super[_0x494b47(0x1a6)](_0x18f0d4);if(!await Config[_0x494b47(0x145)])return _0x298349;const _0x1c92f4=$(_0x494b47(0x15f))[_0x494b47(0x108)](async _0x3cf1db=>{const _0x40d351=_0x494b47;_0x3cf1db[_0x40d351(0xf2)](),_0x3cf1db[_0x40d351(0x13b)](),await this['_parent'][_0x40d351(0x10f)](_0x18f0d4);});return[..._0x298349,_0x1c92f4];}}class ArtBrowserApp extends Application{static[_0x1b3a1b(0x138)](){const _0x3f6cdc=_0x1b3a1b;Hooks['on'](_0x3f6cdc(0x1a3),_0x55234b=>{const _0x243ee0=_0x3f6cdc;if(!game[_0x243ee0(0x165)][_0x243ee0(0x149)])return;this[_0x243ee0(0x101)](_0x55234b),this[_0x243ee0(0x17b)](_0x55234b),this['_preInit_addTokenButton'](_0x55234b),this[_0x243ee0(0xf9)](_0x55234b);}),this[_0x3f6cdc(0x16e)]();}static[_0x1b3a1b(0x16e)](){const _0xc34842=_0x1b3a1b;game[_0xc34842(0x175)][_0xc34842(0x18f)](SharedConsts[_0xc34842(0x132)],_0xc34842(0x1ad),{'name':_0xc34842(0x19c),'editable':[],'onDown':()=>{const _0x350ab6=_0xc34842;return this[_0x350ab6(0xff)](),!![];},'restricted':!![]});}static[_0x1b3a1b(0xff)](){const _0x211af3=_0x1b3a1b;if(ArtBrowserApp[_0x211af3(0x131)]){ArtBrowserApp[_0x211af3(0x131)][_0x211af3(0x11e)](!![]),ArtBrowserApp[_0x211af3(0x131)]['maximize'](),UtilApplications[_0x211af3(0x19e)](ArtBrowserApp[_0x211af3(0x131)]);return;}ArtBrowserApp[_0x211af3(0x131)]=new ArtBrowserApp(),ArtBrowserApp[_0x211af3(0x131)]['render'](!![]);}static[_0x1b3a1b(0x101)](_0x385c57){const _0x48c5da=_0x1b3a1b,_0x3eaf58=_0x385c57[_0x48c5da(0x180)](_0x1b0081=>_0x1b0081['name']===ArtBrowserApp[_0x48c5da(0x19b)]);if(_0x3eaf58)return;_0x385c57[_0x48c5da(0x192)]({'name':ArtBrowserApp[_0x48c5da(0x19b)],'title':_0x48c5da(0x173),'icon':_0x48c5da(0xf1),'tools':[{'name':ArtBrowserApp[_0x48c5da(0x19b)],'title':_0x48c5da(0x173),'icon':_0x48c5da(0xf1),'onClick':()=>ui['notifications'][_0x48c5da(0x127)](_0x48c5da(0x123)),'button':!![]}],'visible':Config[_0x48c5da(0x194)]&&Config[_0x48c5da(0x184)](_0x48c5da(0x12c),'buttonDisplay')[ConfigConsts[_0x48c5da(0x11f)]],'activeTool':_0x48c5da(0x14d)});}static[_0x1b3a1b(0x135)](_0x46ed33){const _0x52b3f8=_0x1b3a1b;return{'name':ArtBrowserApp[_0x52b3f8(0x19b)],'title':_0x52b3f8(0x173),'icon':_0x52b3f8(0xf1),'onClick':()=>{const _0x1e4f93=_0x52b3f8;Config[_0x1e4f93(0x124)](_0x1e4f93(0x12c),_0x1e4f93(0x1b0),_0x46ed33),ArtBrowserApp['_pOpen']();},'visible':Config[_0x52b3f8(0x194)]&&Config[_0x52b3f8(0x184)]('artBrowser',_0x52b3f8(0x155))[_0x46ed33],'button':!![]};}static['_preInit_addTileButton'](_0x52b1fe){const _0x3fff56=_0x1b3a1b;this[_0x3fff56(0x117)](_0x52b1fe,_0x3fff56(0x133),ConfigConsts['C_ART_IMAGE_MODE_TILE']);}static['_preInit_addTokenButton'](_0xfff2ac){const _0x74bca1=_0x1b3a1b;this['_preInit_addSubmenuButton'](_0xfff2ac,'token',ConfigConsts[_0x74bca1(0x11c)]);}static[_0x1b3a1b(0xf9)](_0x49a7f4){const _0x50775f=_0x1b3a1b;this['_preInit_addSubmenuButton'](_0x49a7f4,_0x50775f(0x144),ConfigConsts[_0x50775f(0x15e)]);}static[_0x1b3a1b(0x117)](_0x1d05d0,_0x54c360,_0x297660){const _0x2e04c0=_0x1b3a1b,_0x65155a=_0x1d05d0[_0x2e04c0(0x180)](_0x4f1d8a=>_0x4f1d8a['name']===_0x54c360),_0x41776e=_0x65155a['tools'][_0x2e04c0(0x169)](_0x390e62=>_0x390e62[_0x2e04c0(0x181)]===ArtBrowserApp[_0x2e04c0(0x19b)]);if(_0x41776e)return;_0x65155a[_0x2e04c0(0x116)]['push'](this[_0x2e04c0(0x135)](_0x297660));}static async[_0x1b3a1b(0x134)](_0x564251){const _0x91649a=_0x1b3a1b;await fetch(Config[_0x91649a(0x137)],{'method':_0x91649a(0x1ab),'headers':{'Content-Type':_0x91649a(0x19f)},'body':JSON[_0x91649a(0x160)]({'type':_0x91649a(0x13d),'json':_0x564251,'directoryPath':Config[_0x91649a(0x184)](_0x91649a(0x12c),_0x91649a(0x15d))})});}static[_0x1b3a1b(0x17e)](){const _0x5ea7b7=_0x1b3a1b,_0x200600=ui[_0x5ea7b7(0x187)][_0x5ea7b7(0x13a)][_0x5ea7b7(0x17c)](ui[_0x5ea7b7(0x187)]);ui[_0x5ea7b7(0x187)]['_onClickLayer']=function(_0x15c7c2){const _0x460dbb=_0x5ea7b7;if(_0x15c7c2[_0x460dbb(0x12e)][_0x460dbb(0x148)]['control']===ArtBrowserApp[_0x460dbb(0x19b)]){ArtBrowserApp[_0x460dbb(0xff)]();return;}_0x200600(_0x15c7c2);},$(document[_0x5ea7b7(0x152)])['on']('dragstart',_0x5ea7b7(0x176),_0x15036e=>{const _0x4cd4d8=_0x5ea7b7;_0x15036e[_0x4cd4d8(0xf2)]();}),!UtilGameSettings[_0x5ea7b7(0x115)](_0x5ea7b7(0x11b),_0x5ea7b7(0x16c))&&document[_0x5ea7b7(0x1a7)](_0x5ea7b7(0x128))['addEventListener'](_0x5ea7b7(0x15c),this['_handleCustomDrop']['bind'](this)),game[_0x5ea7b7(0xf6)]['on'](_0x5ea7b7(0x12d),_0x152802=>{const _0x1a9728=_0x5ea7b7;if(_0x152802[_0x1a9728(0x1b1)]!==_0x1a9728(0x11a))return;if(!ArtBrowserApp[_0x1a9728(0x131)])return;if(!ArtBrowserApp['_INSTANCE'][_0x1a9728(0x19a)])return;SceneNavigation['displayProgressBar']({'label':_0x152802[_0x1a9728(0x112)],'pct':_0x152802[_0x1a9728(0x18b)]});}),UtilHooks['on'](UtilHooks[_0x5ea7b7(0x17d)],_0x1b4602=>this[_0x5ea7b7(0x196)](_0x1b4602)),this['_handleConfigUpdate']({'isInit':!![]});}constructor(){const _0xac0158=_0x1b3a1b;super({'title':ArtBrowserApp[_0xac0158(0x18d)],'template':SharedConsts[_0xac0158(0x10d)]+_0xac0158(0x18a),'height':Util[_0xac0158(0x1a1)](),'width':Math[_0xac0158(0x16b)](0x30c,Util[_0xac0158(0x1ae)]()/0x2),'resizable':!![]}),this[_0xac0158(0x19a)]=![],this['_$btnCycleImportMode']=null,this[_0xac0158(0x17a)]=null;}static[_0x1b3a1b(0x196)]({isInit:isInit=![],current:_0x2bc1ee,previous:_0x450d02}={}){const _0x435e63=_0x1b3a1b;if(!this[_0x435e63(0x170)]({'isInit':isInit,'current':_0x2bc1ee,'previous':_0x450d02}))return;if(ui['controls'])ui[_0x435e63(0x187)]['initialize']();}static['_handleConfigUpdate_isRefreshControls']({isInit:isInit=![],current:_0x1ae906,previous:_0x5067d2}={}){const _0x46ff56=_0x1b3a1b;if(isInit)return!![];if(!_0x1ae906||!_0x5067d2)return![];const _0x32daa1=[_0x46ff56(0x12c),_0x46ff56(0x155)];return!CollectionUtil[_0x46ff56(0x147)](MiscUtil[_0x46ff56(0x184)](_0x1ae906,..._0x32daa1),MiscUtil[_0x46ff56(0x184)](_0x5067d2,..._0x32daa1));}[_0x1b3a1b(0x172)](){const _0x3e987b=_0x1b3a1b;this[_0x3e987b(0x121)]();}[_0x1b3a1b(0x121)](){const _0x4a00de=_0x1b3a1b,_0x50844b=Config[_0x4a00de(0x184)](_0x4a00de(0x12c),_0x4a00de(0x1b0))??0x0;switch(_0x50844b){case ConfigConsts['C_ART_IMAGE_MODE_TOKEN']:this[_0x4a00de(0x179)]['html'](_0x4a00de(0x182))['title'](_0x4a00de(0x199)),UtilApplications['setApplicationTitle'](this,ArtBrowserApp[_0x4a00de(0x18d)]+'\x20-\x20Tokens');break;case ConfigConsts[_0x4a00de(0x1a8)]:this[_0x4a00de(0x179)]['html'](_0x4a00de(0x162))[_0x4a00de(0x191)](_0x4a00de(0x114)),UtilApplications[_0x4a00de(0x1a9)](this,ArtBrowserApp[_0x4a00de(0x18d)]+_0x4a00de(0x19d));break;case ConfigConsts[_0x4a00de(0x15e)]:this['_$btnCycleImportMode'][_0x4a00de(0x104)](_0x4a00de(0x100))[_0x4a00de(0x191)](_0x4a00de(0x1af)),UtilApplications[_0x4a00de(0x1a9)](this,ArtBrowserApp[_0x4a00de(0x18d)]+'\x20-\x20Notes');break;case ConfigConsts['C_ART_IMAGE_MODE_SCENE']:this[_0x4a00de(0x179)][_0x4a00de(0x104)]('<span\x20class=\x22fas\x20fa-fw\x20fa-map\x22></span>')[_0x4a00de(0x191)](_0x4a00de(0x125)),UtilApplications[_0x4a00de(0x1a9)](this,ArtBrowserApp[_0x4a00de(0x18d)]+_0x4a00de(0x188));break;default:throw new Error(_0x4a00de(0xf0)+_0x50844b+'\x22');}}[_0x1b3a1b(0xfd)](){const _0x2cb64c=_0x1b3a1b;return{'owner':!![],'entity':{'name':_0x2cb64c(0x173)}};}['activateListeners'](_0x4fdd49){const _0x6481ad=_0x1b3a1b;this[_0x6481ad(0x17a)]=this[_0x6481ad(0x172)][_0x6481ad(0x17c)](this),UtilHooks['on'](UtilHooks['HK_CONFIG_UPDATE'],this['__bound__handleInstanceConfigUpdate']),_0x4fdd49['closest'](_0x6481ad(0x150))[_0x6481ad(0x167)](_0x6481ad(0x109))[_0x6481ad(0x167)](_0x6481ad(0x126));const _0x32b09c=new ArtBrowserFvtt(_0x4fdd49,{'app':this});_0x32b09c[_0x6481ad(0x14e)]()[_0x6481ad(0x161)](()=>{const _0x30f118=_0x6481ad,_0x5c135e=_0x4fdd49[_0x30f118(0x180)](_0x30f118(0x139)),_0x397ed3=$(_0x30f118(0x183))[_0x30f118(0x108)](()=>ArtBrowserApp[_0x30f118(0x190)]());this[_0x30f118(0x179)]=$(_0x30f118(0xfc))[_0x30f118(0x108)](()=>{const _0x4e8a87=_0x30f118,_0x432f6e=Config[_0x4e8a87(0x184)]('artBrowser',_0x4e8a87(0x1b0))||0x0,_0x419c5a=_0x432f6e===ConfigConsts['C_ART_IMAGE_MODE_SCENE']?ConfigConsts['C_ART_IMAGE_MODE_TOKEN']:_0x432f6e+0x1;Config[_0x4e8a87(0x124)](_0x4e8a87(0x12c),'importImagesAs',_0x419c5a);});const _0x27d642=$(_0x30f118(0x154)+(Config['get']('ui','isStreamerMode')?'':_0x30f118(0x166))+_0x30f118(0xf8))[_0x30f118(0x108)](_0x400ebf=>Config['pHandleButtonClick'](_0x400ebf,_0x30f118(0x12c)));$$`<div class="ve-flex-v-center h-100">
					<div class="artr__search__divider mx-2"></div>
					<div class="ve-flex-v-center">${_0x397ed3}</div>
					<div class="ve-flex-v-center">${this[_0x30f118(0x179)]}</div>
					<div class="ve-flex-v-center">${_0x27d642}</div>
				</div>`[_0x30f118(0x143)](_0x5c135e),this[_0x30f118(0x17a)]();});}static async[_0x1b3a1b(0x190)](){const _0x56dbd7=_0x1b3a1b;await fetch(Config[_0x56dbd7(0x137)],{'method':'post','headers':{'Content-Type':'application/json'},'body':JSON[_0x56dbd7(0x160)]({'type':_0x56dbd7(0x111)})});}async[_0x1b3a1b(0x142)](_0x58ebc3,_0x4eb860,_0x1b7835){const _0x3f7a4b=_0x1b3a1b;try{ArtBrowserApp['_INSTANCE'][_0x3f7a4b(0x19a)]=!![],await ArtBrowserApp[_0x3f7a4b(0x134)](_0x58ebc3);}catch(_0x3f3988){ArtBrowserApp['_INSTANCE'][_0x3f7a4b(0x19a)]=![];}_0x4eb860+0x1===_0x1b7835&&(ArtBrowserApp['_INSTANCE'][_0x3f7a4b(0x19a)]=![],ui['notifications'][_0x3f7a4b(0x127)](_0x3f7a4b(0x103)));}async[_0x1b3a1b(0x10f)](_0xbe86cf){const _0x4a9f54=_0x1b3a1b;try{await this['constructor'][_0x4a9f54(0x129)](_0xbe86cf[_0x4a9f54(0x189)]),ui[_0x4a9f54(0x158)][_0x4a9f54(0x127)]('Image\x20downloaded\x20to\x20your\x20Art\x20Directory\x20(\x22'+Config['get']('artBrowser','artDirectoryPath')+'\x22)');}catch(_0x4a5106){ui['notifications'][_0x4a9f54(0xf3)]('Failed\x20to\x20download\x20image!\x20'+VeCt['STR_SEE_CONSOLE']);}}static[_0x1b3a1b(0x14c)](_0x5b5097){const _0x251e27=_0x1b3a1b,_0x20dcd7=UtilEvents[_0x251e27(0x10b)](_0x5b5097);if(_0x20dcd7?.[_0x251e27(0x1b1)]!==_0x251e27(0x1aa))return;return this[_0x251e27(0x15b)](_0x5b5097,_0x20dcd7)['catch'](_0x6b9b7b=>{const _0x1f5249=_0x251e27;ui[_0x1f5249(0x158)][_0x1f5249(0xf3)](_0x1f5249(0x16d)+VeCt[_0x1f5249(0x157)]),setTimeout(()=>{throw _0x6b9b7b;});}),![];}static async['_pDoLoadAndPlaceImage'](_0x503496,_0x399ed3){const _0x3a0655=_0x1b3a1b,_0x1b1e61=Config[_0x3a0655(0x184)](_0x3a0655(0x12c),_0x3a0655(0x1b0))??0x0,_0x29cde6=await this['_pDoLoadAndPlaceImage_pGetImageMeta']({'url':_0x399ed3[_0x3a0655(0x189)]});if(!_0x29cde6)return;const {url:_0x336053,image:_0x421610}=_0x29cde6,_0xee4cd0=()=>{const _0x4d1745=_0x3a0655;let _0x5347c7=_0x336053['split']('/')[_0x4d1745(0x164)]();try{_0x5347c7=decodeURIComponent(_0x5347c7),_0x5347c7=_0x5347c7[_0x4d1745(0x159)]('.')[0x0],_0x5347c7=_0x5347c7['replace'](/_/g,'\x20')[_0x4d1745(0x12a)](/\s+/g,'\x20')[_0x4d1745(0x12a)](/\d+\s*[xX*]\s*\d+/g,'');}catch(_0x51beb6){}return _0x5347c7;},_0x256f1b=_0x421610['naturalWidth'],_0x26e6b4=_0x421610[_0x3a0655(0x198)],_0x3544b7=Config[_0x3a0655(0x184)](_0x3a0655(0x12c),_0x3a0655(0xf5));switch(_0x1b1e61){case ConfigConsts['C_ART_IMAGE_MODE_TOKEN']:{const _0x3e3230=UtilCanvas['getPosCanvasSpace'](_0x503496,'TokenLayer'),_0x1b1eee=Config[_0x3a0655(0x184)]('artBrowser',_0x3a0655(0x110))||0x1;TokenDocument['create']({'name':'-','x':_0x3e3230['x'],'y':_0x3e3230['y'],'img':_0x336053,'width':_0x1b1eee,'height':_0x1b1eee,'scale':0x1},{'parent':canvas['scene']});break;}case ConfigConsts['C_ART_IMAGE_MODE_TILE']:{const _0x32bedd=UtilCanvas[_0x3a0655(0x146)](_0x503496,_0x3a0655(0x1a4));await canvas[_0x3a0655(0x177)]['createEmbeddedDocuments']('Tile',[{'img':_0x336053,'width':Math[_0x3a0655(0x16a)](_0x256f1b*_0x3544b7),'height':Math[_0x3a0655(0x16a)](_0x26e6b4*_0x3544b7),'hidden':![],'scale':_0x3544b7,'x':_0x32bedd['x'],'y':_0x32bedd['y'],'overhead':canvas['foreground']?.['_active']??![]}]);break;}case ConfigConsts[_0x3a0655(0x15e)]:{const _0x1576a5=UtilCanvas[_0x3a0655(0x146)](_0x503496,'NotesLayer'),_0x393ce8=await JournalEntry[_0x3a0655(0x119)]({'name':_0xee4cd0(),'img':_0x336053});await canvas[_0x3a0655(0x177)]['createEmbeddedDocuments'](_0x3a0655(0x12f),[{'entryId':_0x393ce8['id'],'icon':_0x3a0655(0xf7),'iconSize':0x28,'text':'','x':_0x1576a5['x'],'y':_0x1576a5['y']}]);break;}case ConfigConsts['C_ART_IMAGE_MODE_SCENE']:{const _0x4d89ae=Config[_0x3a0655(0x184)](_0x3a0655(0x12c),_0x3a0655(0x17f)),_0xd5df9c={'name':_0xee4cd0(),'active':_0x4d89ae,'navigation':Config[_0x3a0655(0x184)]('artBrowser',_0x3a0655(0x18e)),'img':_0x336053,'width':Math['round'](_0x256f1b*_0x3544b7),'height':Math[_0x3a0655(0x16a)](_0x26e6b4*_0x3544b7),'padding':Config[_0x3a0655(0x184)](_0x3a0655(0x12c),_0x3a0655(0x16f)),'backgroundColor':Config[_0x3a0655(0x184)](_0x3a0655(0x12c),'sceneBackgroundColor'),'tokenVision':Config[_0x3a0655(0x184)]('artBrowser',_0x3a0655(0x102)),'fogExploration':Config[_0x3a0655(0x184)]('artBrowser',_0x3a0655(0x106)),'gridDistance':Config[_0x3a0655(0x118)]({'configGroup':_0x3a0655(0x12c),'originalValue':0x5,'originalUnit':'ft','configKey':_0x3a0655(0x195)}),'gridUnits':Config['getMetricNumberDistance']({'configGroup':_0x3a0655(0x12c),'originalUnit':'ft','configKey':_0x3a0655(0x195)})},_0x3ff103=await Scene[_0x3a0655(0x119)](_0xd5df9c,{'renderSheet':Config[_0x3a0655(0x184)](_0x3a0655(0x12c),'isDisplaySheetCreatedScene')});if(_0x4d89ae)canvas['draw']();break;}}}static async['_pDoLoadAndPlaceImage_pGetImageMeta']({url:_0x4ff35d}){const _0x239aa3=_0x1b3a1b;switch(Config[_0x239aa3(0x184)]('artBrowser',_0x239aa3(0x130))){case ConfigConsts['C_ART_IMAGE_SAVE_MODE__DEFAULT']:{if(await this[_0x239aa3(0x151)](_0x4ff35d)){const _0x54bd47=await UtilImage[_0x239aa3(0x105)](_0x4ff35d);return{'image':_0x54bd47,'url':_0x4ff35d};}return this['_pDoLoadAndPlaceImage_pDoLoadViaBackend']({'url':_0x4ff35d});}case ConfigConsts['C_ART_IMAGE_SAVE_MODE__ALWAYS']:{return this[_0x239aa3(0x107)]({'url':_0x4ff35d});}case ConfigConsts[_0x239aa3(0x10c)]:{if(await this[_0x239aa3(0x151)](_0x4ff35d)){const _0x554cbe=await UtilImage[_0x239aa3(0x105)](_0x4ff35d);return{'image':_0x554cbe,'url':_0x4ff35d};}return null;}}}static async[_0x1b3a1b(0x107)]({url:_0x1a1474}){const _0x220b53=_0x1b3a1b;if(await Config[_0x220b53(0x145)]){if(Config['get'](_0x220b53(0x12c),'imageSaveMode')!==ConfigConsts[_0x220b53(0x10a)])console[_0x220b53(0x14a)](...LGT,'Could\x20not\x20directly\x20load\x20image\x20from\x20'+_0x1a1474+_0x220b53(0x163));try{const _0x2c653d=await this[_0x220b53(0x129)](_0x1a1474);return void _0x2c653d,_0x2c653d;}catch(_0x11dee2){console[_0x220b53(0xf3)](...LGT,_0x220b53(0xfa),_0x11dee2),ui[_0x220b53(0x158)]['error']('Failed\x20to\x20load\x20image!\x20'+VeCt[_0x220b53(0x157)]);return;}}new Dialog({'title':'Art\x20Browserâ€”Backend\x20Mod\x20Required','content':_0x220b53(0x153)+(Config[_0x220b53(0x184)]('ui','isStreamerMode')?SharedConsts[_0x220b53(0x186)]:SharedConsts[_0x220b53(0x120)])+_0x220b53(0x185),'buttons':{'one':{'icon':_0x220b53(0x14f),'label':_0x220b53(0xf4)}}})[_0x220b53(0x11e)](!![]);}static async[_0x1b3a1b(0x151)](_0x432e6a){const _0x10d367=_0x1b3a1b;let _0x34fe81;try{_0x34fe81=new URL(_0x432e6a);}catch(_0xb9c169){}if(_0x34fe81&&ArtBrowserApp['_BLOCKED_HOSTS'][_0x34fe81[_0x10d367(0x171)]])return![];try{const _0x214a5c=await fetch(_0x432e6a);return await _0x214a5c['blob'](),!![];}catch(_0x288b92){if(_0x34fe81)ArtBrowserApp[_0x10d367(0x12b)][_0x34fe81[_0x10d367(0x171)]]=!![];return![];}}static async[_0x1b3a1b(0x1a0)](_0x2ea2cd){const _0x4e9641=_0x1b3a1b,_0x435b45=await fetch(Config[_0x4e9641(0x137)],{'method':_0x4e9641(0x1ab),'headers':{'Content-Type':_0x4e9641(0x19f)},'body':JSON[_0x4e9641(0x160)]({'type':_0x4e9641(0x1a2),'url':_0x2ea2cd,'directoryPath':Config[_0x4e9641(0x184)](_0x4e9641(0x12c),_0x4e9641(0x15d))})}),_0x1871a6=await _0x435b45[_0x4e9641(0x15a)]();return _0x1871a6['path'];}static async[_0x1b3a1b(0x129)](_0x54fc0c){const _0x592de5=await this['_pCopyImageToLocalViaBackend'](_0x54fc0c),_0x3ce31f=await UtilImage['pLoadImage'](_0x592de5);return{'url':_0x592de5,'image':_0x3ce31f};}async[_0x1b3a1b(0x13c)](..._0x29ca50){const _0x1bd026=_0x1b3a1b;await super['close'](..._0x29ca50),UtilHooks[_0x1bd026(0xfb)](UtilHooks[_0x1bd026(0x17d)],this[_0x1bd026(0x17a)]),ArtBrowserApp[_0x1bd026(0x131)]=null;}}ArtBrowserApp[_0x1b3a1b(0x12b)]={},ArtBrowserApp[_0x1b3a1b(0x131)]=null,ArtBrowserApp['_ID_HIDE_TOKEN_BUTTON']=_0x1b3a1b(0x10e),ArtBrowserApp[_0x1b3a1b(0x197)]=_0x1b3a1b(0x156),ArtBrowserApp['_ID_HIDE_NOTES_BUTTON']=_0x1b3a1b(0x1a5),ArtBrowserApp['_ID_HIDE_MAIN_BUTTON']='plutonium__art__hide-main-button',ArtBrowserApp[_0x1b3a1b(0x19b)]=_0x1b3a1b(0x13e),ArtBrowserApp[_0x1b3a1b(0x18d)]=_0x1b3a1b(0x173);export{ArtBrowserApp};